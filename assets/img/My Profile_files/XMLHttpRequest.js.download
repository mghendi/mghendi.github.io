/**
 * XMLHttpRequest.js Copyright (C) 2011 Sergey Ilinsky (http://www.ilinsky.com)
 *
 * This work is free software; you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation; either version 2.1 of the License, or
 * (at your option) any later version.
 *
 * This work is distributed in the hope that it will be useful,
 * but without any warranty; without even the implied warranty of
 * merchantability or fitness for a particular purpose. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this library; if not, write to the Free Software Foundation, Inc.,
 * 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
 */
/* Note: Changes have been done for enhancements and perflog requirements in the application */
window.DEF_FLAG_OF_XMLHTTPREQUEST_JS||(window.DEF_FLAG_OF_XMLHTTPREQUEST_JS=!0,function(){function r(){this._object=k&&!u?new k:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[];for(var a=0,b=l.length;a<b;a++){var e=l[a];e in this._object&&(this[e]=this._object[e])}}function a(){return new r}function t(c){a.onreadystatechange&&a.onreadystatechange.apply(c);c.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0});a.postreadystatechange&&a.postreadystatechange.apply(c)}
var k=window.XMLHttpRequest,v=!!window.controllers,p=!!window.document.namespaces,u=p&&window.navigator.userAgent.match(/MSIE 7.0/),l=["withCredentials","upload","timeout"];a.prototype=r.prototype;v&&k.wrapped&&(a.wrapped=k.wrapped);a.UNSENT=0;a.OPENED=1;a.HEADERS_RECEIVED=2;a.LOADING=3;a.DONE=4;a.prototype.UNSENT=a.UNSENT;a.prototype.OPENED=a.OPENED;a.prototype.HEADERS_RECEIVED=a.HEADERS_RECEIVED;a.prototype.LOADING=a.LOADING;a.prototype.DONE=a.DONE;a.prototype.readyState=a.UNSENT;a.prototype.responseText=
"";a.prototype.responseXML=null;a.prototype.status=0;a.prototype.statusText="";a.prototype.priority="NORMAL";a.prototype.onreadystatechange=null;a.onreadystatechange=null;a.postreadystatechange=null;a.onopen=null;a.onsend=null;a.onabort=null;a.onerror=null;a.onload=null;a.prototype.open=function(c,b,e,f,h){var g=c.toLowerCase();if("connect"==g||"trace"==g||"track"==g)throw Error(18);delete this._headers;3>arguments.length&&(e=!0);this._async=e;var d=this,k=this.readyState,l=null;p&&e&&(l=function(){k!=
a.DONE&&d.abort()},window.attachEvent("onunload",l));a.onopen&&a.onopen.apply(this,arguments);4<arguments.length?this._object.open(c,b,e,f,h):3<arguments.length?this._object.open(c,b,e,f):this._object.open(c,b,e);if(!this.doesAllowCORS()){var m=b?b.indexOf("//"):-1;if(0==m||0<m&&":"==b.charAt(m-1)){var q=window.location;(g=q.origin)?0==m&&(g=g.substring(g.indexOf("//"))):(g=(0==m?"":q.protocol)+"//"+q.hostname,(m=q.port)&&(g+=":"+m));0!=b.toLowerCase().indexOf(g.toLowerCase())&&this.setRequestHeader("X-Allow-CORS",
!0)}}this.readyState=a.OPENED;t(this);this._object.onload=function(a){d.onload?d.onload.apply(this,arguments):d.dispatchEvent&&d.dispatchEvent(a)};this._object.onerror=function(a){d.onerror?d.onerror.apply(this,arguments):d.dispatchEvent&&d.dispatchEvent(a)};this._object.onreadystatechange=function(){d.readyState=d._object.readyState;try{d.response=d._object.response}catch(n){}try{d.responseText=d._object.responseText}catch(n){}try{d.responseType=d._object.responseType}catch(n){}try{d.responseURL=
d._object.responseURL}catch(n){}try{var c=d._object,b=c.responseXML,f=c.responseText;p&&f&&b&&!b.documentElement&&c.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)&&(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.validateOnParse=!1,b.loadXML(f));d.responseXML=b&&(p&&b.parseError&&0!==b.parseError.errorCode||b.documentElement&&"parsererror"==b.documentElement.tagName)?null:b}catch(n){}try{d.status=d._object.status}catch(n){}try{d.statusText=d._object.statusText}catch(n){}d._aborted?
d.readyState=a.UNSENT:d.readyState==a.DONE&&(delete d._data,p&&e&&window.detachEvent("onunload",l),k!=d.readyState&&t(d),k=d.readyState)}};a.prototype.send=function(c){var b="",e=window.pageHeaderJsonData;var f=0;for(var h=l.length;f<h;f++){var g=l[f];g in this._object&&this._object[g]!=this[g]&&(this._object[g]=this[g])}a.onsend&&a.onsend.apply(this,arguments);arguments.length||(c=null);c&&c.nodeType&&(c=window.XMLSerializer?(new window.XMLSerializer).serializeToString(c):c.xml,this._headers["Content-Type"]||
this.setRequestHeader("Content-Type","application/xml"));if(!this.doesAllowCORS()&&(this.setRequestHeader("X-Ajax-Token",String(window.ajaxSecKey)),e)){e.companyId&&(b+="companyId="+encodeURIComponent(e.companyId));if(f=e.pageInfo)f.moduleId&&(b+="&moduleId="+encodeURIComponent(f.moduleId)),f.pageId&&(b+="&pageId="+encodeURIComponent(f.pageId)),f.pageQualifier&&(b+="&pageQualifier="+encodeURIComponent(f.pageQualifier));e.uiVersion&&(b+="&uiVersion="+encodeURIComponent(e.uiVersion));(e=e.userInfo)&&
e.id&&(b+="&userId="+encodeURIComponent(e.id));b&&"&"==b.charAt(0)&&(b=b.substring(1));b&&this.setRequestHeader("X-SAP-Page-Info",b)}this._data=c;this._object.send(this._data)};a.prototype.abort=function(){a.onabort&&a.onabort.apply(this,arguments);this.readyState>a.UNSENT&&(this._aborted=!0);this._object.abort();this.readyState=a.UNSENT;delete this._data};a.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};a.prototype.getResponseHeader=function(a){return this._object.getResponseHeader(a)};
a.prototype.setRequestHeader=function(a,b){function c(a){return f("X-Ajax-Token",a)}this._headers||(this._headers={});var f=function(b,c){c=c||a;return b&&c&&c.toLowerCase()===b.toLowerCase()};if(!c(a)||!Object.keys(this._headers).some(c))if(window.ajaxSecKey&&f(a,"x-csrf-token")&&f(b,"fetch")&&(b=String(window.ajaxSecKey)),this._headers[a]=b,"X-Allow-CORS"!==a)return this._object.setRequestHeader(a,b)};a.prototype.overrideMimeType=function(a){this._object.overrideMimeType&&this._object.overrideMimeType(a)};
a.prototype.addEventListener=function(a,b,e){for(var c=0,h;h=this._listeners[c];c++)if(h[0]==a&&h[1]==b&&h[2]==e)return;this._listeners.push([a,b,e])};a.prototype.removeEventListener=function(a,b,e){for(var c=0,h;(h=this._listeners[c])&&(h[0]!=a||h[1]!=b||h[2]!=e);c++);h&&this._listeners.splice(c,1)};a.prototype.dispatchEvent=function(a){a={type:a.type,target:this,currentTarget:this,eventPhase:2,bubbles:a.bubbles,cancelable:a.cancelable,timeStamp:a.timeStamp,stopPropagation:function(){},preventDefault:function(){},
initEvent:function(){}};"readystatechange"==a.type&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[a]);for(var b=0,c;c=this._listeners[b];b++)c[0]!=a.type||c[2]||(c[1].handleEvent||c[1]).apply(this,[a])};a.prototype.doesAllowCORS=function(){return this._headers&&this._headers["X-Allow-CORS"]};a.prototype.toString=function(){return"[object XMLHttpRequest]"};a.toString=function(){return"[XMLHttpRequest]"};window.XMLHttpRequest=a}());