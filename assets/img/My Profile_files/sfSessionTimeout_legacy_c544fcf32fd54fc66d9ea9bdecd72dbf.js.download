"undefined"==typeof SFSessionTimeout&&(window.SFSessionTimeout=function(){function d(a){this.register();this._init(a)}function e(){this.register();this._init()}d.prototype=function(){return juic.set(new juic.Component,{_init:function(a){this._countdownTimer=new SFCountdown(a,60,"countdownTime");this._countdownTimer.addEventListener("timerExpired",this);this._sessionExpired=!1},setExpiration:function(a){this._countdownTimer.setSecondsToGo(a)},handleEvent:function(a){"timerExpired"==a.type&&this.dispatch("timerExpired")},
renderHtml:function(a){a.push('\x3cdiv class\x3d"sessionTimeoutOuter"\x3e');a.push('\x3cimg class\x3d"sessionTimeoutIcon" src\x3d"',IMAGES["/ui/juic/img/components/yellow_alert_icon.png"],'" alt\x3d"',MSGS.COMMON_Warning,'" /\x3e');a.push('\x3cspan class\x3d"sessionTimeoutInner"\x3e',this._countdownTimer.renderHtml(a),"\x3c/span\x3e");a.push("\x3c/div\x3e")},startCountdown:function(){this._countdownTimer.startCountdown()},cancelCountdown:function(){this._countdownTimer.cancelCountdown()},cleanup:function(){this._countdownTimer.cleanup();
this.unregister()}})}();(function(){juic.extend(e,juic.Component,{_init:function(){this._originalWindowTitle=document.title;this._notifyBrowserWindow()},_notifyBrowserWindow:function(){this._updateWindowTitle(MSGS.COMMON_SESSION_ABOUT_TO_TIME_OUT)},_updateWindowTitle:function(a){document.title=a},_getFavIcon:function(){var a=document.getElementsByTagName("link"),b;for(b=0;b<a.length;b+=1)if("shortcut icon"===a[b].getAttribute("rel")||"icon"===a[b].getAttribute("rel"))return a[b].getAttribute("href");
return""},updateBrowserWindow:function(a,b){this._updateWindowTitle(b)},restoreBrowserWindow:function(){this._updateWindowTitle(this._originalWindowTitle)}})})();return juic.set(new juic.EventTarget,{init:function(){this.sessionTimer=new SFSessionTimer;this.sessionTimer.addEventListener("sessionWarning",this);this.sessionTimer.addEventListener("sessionTimedOut",this);this.sessionTimer.addEventListener("sessionAboutToExpire",this);this.sessionTimer.addEventListener("sessionExtended",this);this.sessionTimer.addEventListener("sessionPrewarning",
this);"undefined"===typeof window.sessionTimerObj&&(window.sessionTimerObj=this.sessionTimer);var a=this.sessionTimer;AjaxService.addPreHook(function(){a.isExpired()||a.reset()});this.sessionTimeoutMessage=new d(this.getWarningCountdown());this.sessionTimeoutMessage.addEventListener("timerExpired",this);this.isGreaterThanVersion11=!0;this.setStayOnPageAfterTimeout(!0);this.inited=!0;this._runCallbackInInit()},getWarningCountdown:function(){return this.sessionTimer.getWarningCountdown()},_addCallbackInInit:function(a){this.initCallbacks||
(this.initCallbacks=[]);this.initCallbacks.push(a)},_runCallbackInInit:function(){if(this.initCallbacks)for(var a=0;a<this.initCallbacks.length;a++)this.initCallbacks[a].call(this)},considerUserActivity:function(){this.inited?(this._considerUserActivity=!0,this.userActivityListener||(this.userActivityListener=new SFUserActivityListener,this.userActivityListener.addEventListener("userActivity",this,"_handleUserActivity"),this.userActivityListener.startListening())):this._addCallbackInInit(this.considerUserActivity)},
initWarningDlg:function(){var a=[{label:MSGS.COMMON_Logout,eventName:"logout",active:!1},{label:MSGS.COMMON_KEEP_WORKING,eventName:"keepAlive",active:!0}];this.warningDlg=this.isGreaterThanVersion11?new SFDialogBox({title:MSGS.COMMON_SESSION_INFORMATION,content:this.sessionTimeoutMessage,buttons:a,width:420,height:50,responsive:!0}):new SFDialog(MSGS.COMMON_SESSION_INFORMATION,this.sessionTimeoutMessage,a,300,60,!0);this.warningDlg.setShowCloseIcon(!1);this.warningDlg.addEventListener("hideRequest",
this);this.warningDlg.addEventListener("action",this)},_handleUserActivity:function(){this._lastUserActivityTime=(new Date).valueOf();this.userActivityListener.stopListening();var a=this;window.setTimeout(function(){a.userActivityListener&&a.userActivityListener.startListening()},3E5)},ignoreUserActivity:function(){this.inited?(this._considerUserActivity=!1,this.userActivityListener&&(this.userActivityListener.stopListening(),this.userActivityListener.removeEventListener("userActivity",this),this.userActivityListener=
null)):this._addCallbackInInit(this.ignoreUserActivity)},handleEvent:function(a){var b=this,c=function(){switch(a.type){case "sessionWarning":b._cleanUpTimedOutDialog();b._sessionWarning(Math.ceil(b.getWarningCountdown()/1E3));break;case "sessionPrewarning":b._cleanUpWarningDialog();b._cleanUpTimedOutDialog();break;case "sessionTimedOut":case "timerExpired":b._cleanUpWarningDialog();b._sessionTimedOut();break;case "sessionAboutToExpire":b.dispatchEvent(a);b._sessionWarning(60);break;case "sessionExtended":b.dispatchEvent(a);
break;case "action":"keepAlive"!=a.actionCommand&&"hideRequest"!=a.actionCommand||b._keepAlive(),"logout"==a.actionCommand&&(b._sessionTimedOut(!0),b.endSession())}};this.isGreaterThanVersion11?SMRF.load(["/ui/sfgrp/js/juicLayoutUtils.js","/ui/sfgrp/js/juicPopupsV12.js"],function(){c()}):SMRF.load(["/ui/sfgrp/js/juicLayoutUtils.js","/ui/sfgrp/js/juicPopupsV11.js"],function(){c()})},endSession:function(){this.sessionTimer&&this.sessionTimer.endSession()},_cleanUpWarningDialog:function(){juic.$(this.warningDlg)&&
juic.$(this.warningDlg.id)&&(this.warningDlg.close(),this._getBrowserNotifyInstance().restoreBrowserWindow(),this.sessionTimeoutMessage.cancelCountdown())},_cleanUpTimedOutDialog:function(){juic.$(this._sessionExpiredDialog)&&juic.$(this._sessionExpiredDialog.id)&&this._sessionExpiredDialog.close()},_keepAlive:function(){this._sessionExpired=!1;this.sessionTimeoutMessage.cancelCountdown();this.warningDlg&&this.warningDlg.close();this.sessionTimer.dispatch("sessionKeepAlive");this.keepAlive()},keepAlive:function(){this.sessionTimer&&
this.sessionTimer.keepAlive();this.userActivityListener&&this.userActivityListener.startListening();this._getBrowserNotifyInstance().restoreBrowserWindow()},reset:function(){this.sessionTimer&&this.sessionTimer.reset();this.userActivityListener&&this.userActivityListener.startListening()},_getBrowserNotifyInstance:function(){this._notifyBrowser||(this._notifyBrowser=new e);return this._notifyBrowser},_sessionWarning:function(a){this._sessionExpired||(this.warningDlg?this.sessionTimeoutMessage.setExpiration(a):
this.initWarningDlg(),this._isUserActive()||juic.$(this.warningDlg.id)||(this.sessionTimeoutMessage.setExpiration(a),this.sessionTimeoutMessage.startCountdown(),this._getBrowserNotifyInstance(),this.isGreaterThanVersion11?(this.warningDlg.showDialog(!0,document.activeElement),this.warningDlg.setShowCloseIcon(!1)):(this.warningDlg.setCloseDialogOnEsc(!0),this.warningDlg.showDialog())))},_isUserActive:function(){var a=!1;if(this._considerUserActivity){var b=(new Date).valueOf()-this._lastUserActivityTime,
c=this.sessionTimer.getSessionInterval()-6E4*this.sessionTimer.getSessionTimeoutWarningTime();b<c&&(this.keepAlive(),a=!0)}return a},setStayOnPageAfterTimeout:function(a){this._stayOnPageAfterTimeout=a},_sessionTimedOut:function(a){this.warningDlg||this.initWarningDlg();juic.$(this.warningDlg.id)&&this.warningDlg.close();this._sessionExpired=!0;!a&&this._stayOnPageAfterTimeout?this._showSessionTimedOutDialog():this._routeUserLogout(!1)},_routeUserLogout:function(a){var b=window.pageHeaderJsonData,
c;if(b&&!a){if(this.sessionTimer.dispatch("sessionLogout"),a=b.utilityLinks.links)for(b=a.length;b--;)if(c=a[b],c.label===MSGS.COMMON_Logout){var f=c.url;c.onclick&&!1===(new Function(c.onclick)).call(c)&&(f=null);f&&Util.gotoURL(f)}}else this.sessionTimer.dispatch("sessionLogin"),this._logoutAndRedirectToLogin()},_logoutAndRedirectToLogin:function(){"undefined"!==typeof rcmCareerSiteConfig&&rcmCareerSiteConfig&&rcmCareerSiteConfig.isInternalCareerSite&&"true"==rcmCareerSiteConfig.isInternalCareerSite&&
logoutURL?window.location.replace(logoutURL):this.sessionTimer.sessionTimeoutController.invalidateSession({callback:this._redirectToLogin,exceptionHandler:this._redirectToLogin})},_redirectToLogin:function(){try{window.setLocation(AjaxService.getRedirectUrl())}catch(a){}},cleanup:function(){this.warningDlg&&this.warningDlg.cleanup();this.sessionTimer.cleanup();this.sessionTimeoutMessage.isRegistered()&&this.sessionTimeoutMessage.cleanup()},setSessionTimedOutAddonMsg:function(a){this._sessionTimedOutAddonMsg=
a},_showSessionTimedOutDialog:function(){var a=this.sessionTimer.enableSessionTimeoutAutomaticRedirect;if(!this._sessionExpiredDialog){var b=juic.set(new Component,{setAddonMsg:function(a){this._addonMsg=a},renderHtml:function(a){var b=Util.isMobile()?" sessionTimeoutMobile":"";a.push('\x3cdiv class\x3d"sessionTimeoutOuter'+b+'"\x3e');a.push('\x3cdiv class\x3d"sessionIconContainer"\x3e');a.push('\x3cimg class\x3d"sessionTimeoutIcon" src\x3d"',IMAGES["/ui/juic/img/components/yellow_alert_icon.png"],
'" alt\x3d"',MSGS.COMMON_Warning,'" /\x3e');a.push("\x3c/div\x3e");a.push('\x3cdiv class\x3d"sessionMessage"\x3e',MSGS.COMMON_SESSION_EXPIRED_MESSAGE_DETAILS,"\x3c/div\x3e");a.push(new clearingDiv);a.push("\x3c/div\x3e");this._addonMsg&&(a.push("\x3cbr /\x3e"),a.push(this._addonMsg))}});this._sessionTimedOutAddonMsg&&b.setAddonMsg(this._sessionTimedOutAddonMsg);if(this.isGreaterThanVersion11)this._sessionExpiredDialog=new SFDialogBox({title:MSGS.COMMON_SESSION_TIMED_OUT,content:b,buttons:[{label:MSGS.COMMON_Close,
eventName:"close",active:!1},{label:MSGS.COMMON_LOGIN,eventName:"logout",active:!0}],width:420,height:50,responsive:!0,showCloseIcon:!1,useNameAnchor:!0});else{var c=Util.isMobile()?300:420;this._sessionExpiredDialog=new SFDialog("",b,[{label:MSGS.COMMON_LOGIN,eventName:"logout",active:!0}],c,110,!1,0,!0)}this._sessionExpiredDialog.addEventListener("action",this,"_handleSessionExpiredDialogEvent")}this.warningDlg&&this.warningDlg.id&&juic.$(this.warningDlg.id)&&this.warningDlg.close();this.isGreaterThanVersion11?
(this._sessionExpiredDialog.showDialog(),this._getBrowserNotifyInstance()._updateWindowTitle(MSGS.COMMON_SESSION_EXPIRED_MESSAGE)):(this._sessionExpiredDialog.setCloseDialogOnEsc(!0),this._sessionExpiredDialog.showDialog());a&&this._handleRedirectToSessionTimeoutPage()},_handleRedirectToSessionTimeoutPage:function(){this.sessionTimer.sessionTimeoutController.invalidateSession({callback:this.redirectToSessionTimeoutPage(this),exceptionHandler:this.redirectToSessionTimeoutPage})},redirectToSessionTimeoutPage:function(a){document.location.replace(this._getSessionTimeoutPageUrl(a))},
_getSessionTimeoutPageUrl:function(a){var b=this.sessionTimer.sessionTimeoutAutomaticRedirectUrl;b||(a&&a.sessionTimer.setSessionExpirationTimeByDelta(0),b=(a=window.pageHeaderJsonData)&&a.userLocale||"",b="/ui/platform/resources/error/session_timeout.html?company\x3d"+encodeURIComponent(a&&a.companyId||"")+"\x26userLocale\x3d"+encodeURIComponent(b));return b},_handleSessionExpiredDialogEvent:function(a){a&&"logout"==a.actionCommand&&this._routeUserLogout(!0);a&&"close"==a.actionCommand&&this._sessionExpiredDialog.close()},
isSessionExpired:function(){return this._sessionExpired}})}(),["setInitialLastPageVisited","clearLastPageVisited","setCurrentPageAsLastVisited"].forEach(function(d){SFSessionTimeout[d]=function(){var e=window.LastPageVisitedUtil,a=e&&e[d];a&&a.apply(e,arguments)}}),function(){var d=function(){SMRF.load(["/ui/sfgrp/js/juicSession.js"],function(){SFSessionTimeout.init()})};window.SFDOMEvent?SFDOMEvent.subscribeToOnDomReadyWithPriority("HIGHEST",d):window.jQuery?jQuery(document).ready(d):window.setTimeout(d,
1)}());