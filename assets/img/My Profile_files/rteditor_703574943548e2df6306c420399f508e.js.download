function RTEditor(l,n){juic.assert({object:1,undefined:1}[typeof n],"options argument is not an object");RTEditor.prototype.totalInstances?++RTEditor.prototype.totalInstances:RTEditor.prototype.totalInstances=1;this.numInstance=RTEditor.prototype.totalInstances;this._gname="juic_RTEditor_"+this.numInstance;window[this._gname]=this;this._setValueInternal(l);this._prevValue=this._valueOriginal=this._valueSet;this._options=n||{};this._options.name&&(this.gnameAlt="juic_RTEditor_alt_"+this._options.name,
window[this.gnameAlt]=this);this._label=(this._useDefaultLabel=!!this._options.label)?MSGS.get("COMMON_RTE_LABEL",this._options.label):MSGS.COMMON_RTE_DESCRIPTION;this._initPanelDimensions();juic.assert({string:1,undefined:1}[typeof this._options.name],"options.name is not a string");this._init()}RTEditor.msgs=window.MSGS||{};RTEditor.DEFAULT_HIGHLIGHT_BG_COLOR="#FCC";
(function(){function l(a,b){return function(){return b.apply(a,arguments)}}function n(a,b,c,d,e){this.title=b?b:a;this.cssClass=c;this.hex=e;this._options=d||{};this.register()}function t(a,b,c,d,e,f){this.optionsList=c;this.title=a;this.desc=b;this._defaultOption=d;this.dropdown=new SFDropDown(this.optionsList,this.title,this.desc);this.dropdown.setClassName("nrte_select");this.register();var g=this;f&&e&&this.dropdown.addEventListener("change",new function(a,b){this.handleEvent=function(){f._execCommand(a,
b,g.getValue())}}(e))}function u(a,b){this._optionsMButton=a||{};this._optionsToolbar=b||{};this.register();var c=RTEditor.msgs;this.btn=new n(c.COMMON_RTE_TOOLBAR_TEXT_COLOR||"Text Color",c.COMMON_RTE_TOOLBAR_TEXT_COLOR_BUTTON_DESC,"textColor",this._optionsMButton);this.btn.addEventListener("click",{el:this,handleEvent:function(){this.el.showDisplay()}});this.colors=[new n(c.COMMON_RTE_TOOLBAR_TEXT_COLOR_RED||"Red",null,"red",this._optionsToolbar.buttons,"#FF0000"),new n(c.COMMON_RTE_TOOLBAR_TEXT_COLOR_ORANGE||
"Orange",null,"orange",this._optionsToolbar.buttons,"#FF6600"),new n(c.COMMON_RTE_TOOLBAR_TEXT_COLOR_YELLOW||"Yellow",null,"yellow",this._optionsToolbar.buttons,"#FFFF00"),new n(c.COMMON_RTE_TOOLBAR_TEXT_COLOR_GREEN||"Green",null,"green",this._optionsToolbar.buttons,"#008000"),new n(c.COMMON_RTE_TOOLBAR_TEXT_COLOR_BLUE||"Blue",null,"blue",this._optionsToolbar.buttons,"#0000FF"),new n(c.COMMON_RTE_TOOLBAR_TEXT_COLOR_VIOLET||"Violet",null,"violet",this._optionsToolbar.buttons,"#6363FF"),new n(c.COMMON_RTE_TOOLBAR_TEXT_COLOR_BLACK||
"Black",null,"black",this._optionsToolbar.buttons,"#000000")];for(c=0;c<this.colors.length;++c)this.colors[c].addEventListener("click",{el:this,color:this.colors[c].hex,handleEvent:function(){this.el.dispatch("color",{color:this.color})}})}function r(){return"\x3cscript type\x3d'text/javascript'\x3esetTimeout(function () { document.forms[0].submit(); }, 1);\x3c/script\x3e"}var v=Util.browserInfo.ff,p=Util.browserInfo.saf,w=Util.isChrome(),q=p&&!w&&/Mobile/.test(navigator.userAgent)&&5.1>Util.safariVersion(),
m=Util.ieVersion(!0)||p&&!q||w;(function(a,b){this.register();this._max=a;this._count=b?b:0}).prototype=function(){return juic.set(new juic.Component,{renderHtml:function(a){a.push('\x3cspan id\x3d"'+this.id+'" class\x3d"nrte_char_counter" title\x3d"',MSGS.COMMON_RTE_COUNTER_CHARACTER_MESSAGE,'"\x3e');this.renderInner(a);a.push("\x3c/span\x3e")},renderInner:function(a){var b;b=this._max;var c=this._count;b=0<b-c?b-c:0;a.push("Chars left: ",0==b?'\x3cspan style\x3d"color:red"\x3e':"",b,0==b?"\x3c/span\x3e":
"")},setMax:function(a){this._max=a;juic.$(this.id)&&(a=[],this.renderInner(a),juic.$(this.id).innerHTML=a.join(""))},getMax:function(){return this._max},setCount:function(a){this._count=a;juic.$(this.id)&&(a=[],this.renderInner(a),juic.$(this.id).innerHTML=a.join(""))},getCount:function(){return this._count}})}();RTEditor.attachTBBtnEvent=function(a){a=juic.$(a).getElementsByTagName("a");for(var b=0,c=a.length;b<c;b++){var d=a[b];d.id&&0==d.id.indexOf("link_icon_")&&d.rel&&(d.onclick=function(a){juic.fire(this.rel,
"_click",a);return!1},d.onmousedown=function(a){a=a||event;juic.fire(this.rel,"_down",a);return!1},d.onmouseup=function(a){a=a||event;juic.fire(this.rel,"_up",a);return!1},d.onmouseover=function(a){a=a||event;juic.fire(this.rel,"_over",a);return!1},d.onmouseout=function(a){a=a||event;juic.fire(this.rel,"_out",a);return!1})}};n.prototype=juic.set(new juic.Component,{_DEFAULT_BORDER_COLOR:"#ececec",_active:0,_hover:0,_pressed:0,renderHtml:function(a){a.push("\x3cdiv role\x3d'none' id\x3d'",this.id,
"' style\x3d'border-color:",this._getOptBorderColor(),";'class\x3d'nrte_button_div'\x3e\x3ca href\x3d'javascript:void(0)' id\x3d'link_icon_",this.id,"' title\x3d'",juic.escapeHTML(this.title),"'");a.push(" class\x3d'nrte_button_link ",this.cssClass);this._options&&this._options.disabled&&a.push(" disabled");a.push("'");this._options&&this._options.disabled?a.push(' onclick\x3d"return false;" role\x3d"button" '):a.push(' rel\x3d"',this.id,'"');a.push(" ondragstart\x3d'javascript:return(false);'");
a.push(" unselectable\x3d'on'\x3e");a.push("\x3c/a\x3e");a.push("\x3c/div\x3e")},getPos:function(){var a=juic.$(this.id);return Util.getAbsPos(a)},_click:function(){this.dispatch("click")},_getOptBorderColor:function(){return this._options&&this._options.border&&this._options.border.color?this._options.border.color:this._DEFAULT_BORDER_COLOR},_updateView:function(){var a=juic.$(this.id);if(a){var b=this._getOptBorderColor();this._options&&this._options.disabled||(this._active?b="#808080 #fff #fff #808080":
this._pressed?b="#808080 #fff #fff #808080":this._hover&&(b="#fff #808080 #808080 #fff"));a.style.borderColor=b}},setActive:function(a){this._active=a;this._updateView()},_over:function(){this._hover=1;this._updateView()},_out:function(){this._pressed=this._hover=0;this._updateView()},_down:function(){this._pressed=1;this._updateView()},_up:function(){this._pressed=0;this._updateView()}});t.prototype=juic.set(new juic.Component,{renderHtml:function(a){this.dropdown.renderHtml(a);return a},getValue:function(){return this.dropdown.getValue()},
setValue:function(a){a?this.dropdown.setValue(a,!0):this._defaultOption&&this.dropdown.setValue(this._defaultOption,!0)},cleanup:function(){this.dropdown.cleanup();this.unregister()}});u.prototype=juic.set(new juic.Component,{_DEFAULT_BACKGROUND_COLOR:"#eee",_DEFAULT_BORDER_COLOR:"#ccc",cleanup:function(){if(this.colors&&this.colors.length)for(var a=0;a<this.colors.length;++a)this.colors[a].cleanup();this.unregister()},renderHtml:function(a){this.btn.renderHtml(a);a.push("\x3cdiv style\x3d'","background:",
this._getOptToolbarBackground(),";","border:1px solid ",this._getOptToolbarBorderColor(),";","' class\x3d'nrte_color_div' id\x3d'",this.id,"'\x3e","\x3cul class\x3d'nrte_color_ul' style\x3d'width:",22*this.colors.length+4,"px;' onmouseover\x3d'",this.fireCode("_over"),"' onmouseout\x3d'",this.fireCode("_out"),"'\x3e");for(var b=0;b<this.colors.length;++b)a.push("\x3cli style\x3d'border:none;display:inline;margin:0px;padding:0px;'\x3e"),this.colors[b].renderHtml(a),a.push("\x3c/li\x3e");a.push("\x3c/ul\x3e\x3c/div\x3e")},
_getOptToolbarBackground:function(){return this._optionsToolbar&&this._optionsToolbar.background?this._optionsToolbar.background:this._DEFAULT_BACKGROUND_COLOR},_getOptToolbarBorderColor:function(){return this._optionsToolbar&&this._optionsToolbar.border&&this._optionsToolbar.border.color?this._optionsToolbar.border.color:this._DEFAULT_BORDER_COLOR},_over:function(){this._tid&&(clearTimeout(this._tid),delete this._tid)},_out:function(){var a=this;this._tid=setTimeout(function(){a.hideDisplay()},500)},
hideDisplay:function(){var a=juic.$(this.id);a&&(a.style.display="none",SFDOMEvent.removeListener(window.document,"click",this.hideDisplay))},showDisplay:function(){var a=juic.$(this.id);if(a){var b=a.style;b.display="block";a="link_icon_"+a.childNodes[0].childNodes[0].firstChild.id;juic.$(a)&&juic.$(a).focus();var c=this;setTimeout(function(){"none"!=b.display&&SFDOMEvent.addListener(window.document,"click",c.hideDisplay,c)},10)}}});juic.extend(RTEditor,SFDragResizer,{cleanup:function(){if(this._tb){var a=
this._tb;a.bold&&a.bold.cleanup();a.italic&&a.italic.cleanup();a.underline&&a.underline.cleanup();a.numbers&&a.numbers.cleanup();a.bullets&&a.bullets.cleanup();a.indent&&a.indent.cleanup();a.outdent&&a.outdent.cleanup();a.createLink&&a.createLink.cleanup();a.textColor&&a.textColor.cleanup();a.fontSize&&a.fontSize.cleanup();a.spellCheck&&a.spellCheck.cleanup();a.legalScan&&a.legalScan.cleanup();a.waca&&a.waca.cleanup();a.notebook&&a.notebook.cleanup()}this.unregister()},_DEFAULT_RTE_HEIGHT:200,_DEFAULT_RTE_BORDER_WIDTH:1,
_DEFAULT_RTE_AUTOGROW_HEIGHT:200,_DEFAULT_TEXTPANE_BORDER_COLOR:"#ddd",_DEFAULT_TEXTPANE_BORDER_STYLE:"solid",_DEFAULT_TEXTPANE_PADDING:5,_DEFAULT_TOOLBAR_BACKGROUND:"#f3f3f3",_DEFAULT_TOOLBAR_BORDER_COLOR:"#ddd",_DEFAULT_TOOLBAR_BORDER_STYLE:"solid",_DEFAULT_TOOLBAR_BUTTON_HEIGHT:16,_DEFAULT_TOOLBAR_HEIGHT:29,_isLimiterDIVVisible:!1,_init:function(){function a(a,b,d){this.handleEvent=function(){c._execCommand(a,b,d);c._update(!0)}}function b(b,d,g,k,h,m,l){if(l)return null;l={border:{color:c._getOptToolbarButtonsBorderColor()},
disabled:!k};b=new n(b,d,g,l);b.addEventListener("click",new a(k,h,m));return b}var c=this;this.register();this.setOptions&&this.setOptions(this._options);this._options&&this._options.allowAutoGrow&&(this._allowAutoGrow=this._options.allowAutoGrow,this._autoGrow_minHeight=this._options.height?this._options.height:this._DEFAULT_RTE_HEIGHT,this._autoGrow_maxHeight=parseInt(this._autoGrow_minHeight)+this._DEFAULT_RTE_AUTOGROW_HEIGHT);var d=new SFDefaultSingleSelectModel([new SFSimpleSelectItem("3",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE||
"Size"),new SFSimpleSelectItem("1",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_EXTRA_SMALL||"XS"),new SFSimpleSelectItem("2",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_SMALL||"S"),new SFSimpleSelectItem("4",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_LARGE||"L"),new SFSimpleSelectItem("5",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_EXTRA_LARGE||"XL"),new SFSimpleSelectItem("6",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_DOUBLE_EXTRA_LARGE||"XXL"),new SFSimpleSelectItem("7",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_TRIPLE_EXTRA_LARGE||"XXXL")]);this._tb=
{bold:b(MSGS.COMMON_RTE_TOOLBAR_BOLD||"Bold",MSGS.COMMON_RTE_TOOLBAR_BOLD_DESC,"bold","bold"),italic:b(MSGS.COMMON_RTE_TOOLBAR_ITALIC||"Italic",MSGS.COMMON_RTE_TOOLBAR_ITALIC_DESC,"italic","italic"),underline:b(MSGS.COMMON_RTE_TOOLBAR_UNDERLINE||"Underline",MSGS.COMMON_RTE_TOOLBAR_UNDERLINE_DESC,"underline","underline"),numbers:b(MSGS.COMMON_RTE_TOOLBAR_NUMBERING||"Numbering",MSGS.COMMON_RTE_TOOLBAR_NUMBERING_DESC,"numbering","insertorderedlist"),bullets:b(MSGS.COMMON_RTE_TOOLBAR_BULLETS||"Bullets",
MSGS.COMMON_RTE_TOOLBAR_BULLETS_DESC,"bullets","insertunorderedlist"),outdent:b(MSGS.COMMON_RTE_TOOLBAR_OUTDENT||"Outdent",MSGS.COMMON_RTE_TOOLBAR_OUTDENT_DESC,"outdent","outdent"),indent:b(MSGS.COMMON_RTE_TOOLBAR_INDENT||"Indent",MSGS.COMMON_RTE_TOOLBAR_INDENT_DESC,"indent","indent"),fontSize:new t(MSGS.COMMON_RTE_TOOLBAR_FONT_SIZE||"Font Size",MSGS.COMMON_RTE_TOOLBAR_FONT_SIZE_DESC,d,3,"fontSize",c),createLink:b(MSGS.COMMON_RTE_TOOLBAR_HYPERLINK||"Hyperlink",MSGS.COMMON_RTE_TOOLBAR_HYPERLINK_DESC,
"hyperlink","createLink",!0),textColor:new u({border:{color:this._getOptToolbarButtonsBorderColor()}},this._getOptToolbarSub()),spellCheck:b(MSGS.COMMON_RTE_TOOLBAR_SPELL_CHECK||"Spell Check",MSGS.COMMON_RTE_TOOLBAR_SPELL_CHECK_DESC,"spellCheck",this._options&&this._options.spellCheck?"_popUpSpellCheck":null,null,null,this._options&&this._options.hideSpellCheck),legalScan:b(MSGS.COMMON_RTE_TOOLBAR_LEGAL_SCAN||"Legal Scan",MSGS.COMMON_RTE_TOOLBAR_LEGAL_SCAN_DESC,"legalScan",this._options&&this._options.legalScan?
"_popUpLegalScan":null,null,null,this._options&&this._options.hideLegalScan),waca:b(MSGS.COMMON_RTE_TOOLBAR_WRITING_ASSISTANT||"Writing Assistant",MSGS.COMMON_RTE_TOOLBAR_WRITING_ASSISTANT_DESC,"writeAssistant",this._options&&this._options.waca?"_popUpWACA":null,null,null,this._options&&this._options.hideWaca),notebook:b(MSGS.COMMON_RTE_TOOLBAR_NOTEBOOK||"Notebook",MSGS.COMMON_RTE_TOOLBAR_NOTEBOOK_DESC,"notebook",this._options&&this._options.notebook?"_notebook":null)};if(this._maxLength=this._options.maxChars)this._options.maxCharWarning=
"undefined"==typeof this._options.maxCharWarning?!1:this._options.maxCharWarning,juic.assert(100<=this._maxLength,"maxchar cannot be less than 100"),this._maxLength=100<this._maxLength?this._maxLength:100,this._highlightOverflowTextMode=this._options.highlightOverflowTextMode,this._textLimiter=new SFTextLimiter(this._maxLength,!0,this.id,this._highlightOverflowTextMode),this._textLimiter.addEventListener("limiterAction",this,"_handleLimiterEvent"),this._textLimiter.checkLimiter(this.getValue()),this._highlightOverflowTextMode?
this._update():(d=Util.isFioriEnabled()?150:100,this.textLimiterAutoTrim(),this._charLimitDialog=new SFDialog(MSGS.COMMON_Err,new SFSysMsg("alert",MSGS.get("COMMON_RTE_MAXIMUM_CHAR_LIMIT_MESSAGE",this._maxLength)),[{label:MSGS.COMMON_Ok,enabled:!0,active:!0,eventName:"done"}],400,d),this._pasteLimitDialog=new SFDialog(MSGS.COMMON_Err,new SFSysMsg("alert",MSGS.get("COMMON_RTE_MAXIMUM_PASTE_LIMIT_MESSAGE",this._maxLength)),[{label:MSGS.COMMON_Ok,enabled:!0,active:!0,eventName:"done"}],400,d),this._charLimitDialog.addEventListener("action",
{handleEvent:function(a){c._dialogVisible=!1;c._resetValue();"done"==a.actionCommand&&c._charLimitDialog.close()}}),this._pasteLimitDialog.addEventListener("action",{handleEvent:function(a){c._dialogVisible=!1;"done"==a.actionCommand&&c._pasteLimitDialog.close()}}));this._tb.textColor.addEventListener("color",{handleEvent:function(a){c._execCommand("forecolor",!1,a.color)}});this._initResizer(this._options)},_initPanelDimensions:function(){this._options&&this._setPaneHeight(this._options);this._options.width&&
(this._paneWidth=this._options.width)},_getEditorHeight:function(a){a&&this._setPaneHeight(a);return m?this._paneHeight-2*this._DEFAULT_TEXTPANE_PADDING:this._paneHeight},_setPaneHeight:function(a){a.height||(a.height=this._DEFAULT_RTE_HEIGHT);this._paneHeight=this.isReadOnly()||this.isToolbarHidden()?a.height-2*this._DEFAULT_RTE_BORDER_WIDTH:a.height-2*this._DEFAULT_RTE_BORDER_WIDTH-this._DEFAULT_TOOLBAR_HEIGHT},_initResizer:function(a){this._allowResize=!!a.allowResize;this._dimension=a.dimension||
{};this._minDimensions=a.minDimensions||{};this._maxDimensions=a.maxDimensions||{}},setResizable:function(){},getResizable:function(){return this},setDimension:function(a){this._dimension=a;this._setStyles(a)},getDimension:function(){this._getDimensions();return this._dimension},resize:function(){},getMinDimension:function(){this._minDimensions&&this._minDimensions.width||(this._minDimensions={width:"410",height:SFDom.getDefaultFontSize()[1]+27+14});return this._minDimensions},getMaxDimension:function(){return this._maxDimensions},
handleAfterRenderListener:function(){this._getDimensions();this._dimension.width=this._fullWidth||this._dimension.width;this._setStyles(this._dimension)},_getDimensions:function(){var a=this.id+"_wrapper",b={};juic.$(a)&&(b=SFDom.getRegion(a));this._dimension=b},_setStyles:function(a){var b=juic.$(this.id+"_wrapper"),c=SFDom.getStyle(b,"border-width"),c=c?2*parseInt(c):0;SFDom.setStyle(b,"width",a.width-c+"px");SFDom.setStyle(b,"height",a.height-c+"px");a=this._getEditorHeight(a);b=juic.$(this.id+
"_editor");(b?b:juic.$(this.id)).style.height=a+"px"},getValue:function(){var a=juic.$(this.id);if(!a)return this._valueSet;if(m){var b=a.innerHTML;return b=b.replace(/^<br><\/br>|^<div><br><\/div>|^<br>/g,"")}(b=a.contentDocument&&a.contentDocument.body&&a.contentDocument.body.innerHTML)&&b!=this._valueOriginal&&v?b=b.replace(/^<br><\/br>|^<div><br><\/div>|^<br>/g,""):q&&(b=a.value);return b},getValueEscaped:function(){return this._txtEscQuotes(this._txtEscEntities(this.getValue()))},getValuePlain:function(){return this._txtUnEscEntities(this.getValue())},
getValuePlainWithLinkBreaks:function(){return this._txtUnEscEntitiesWithLinkBreaks(this.getValue())},getValueStripped:function(){return this._txtTranslateHTML(this.getValue())},isReadOnly:function(){return this._options&&this._options.readOnly},isValueBlank:function(){var a=11<=Util.ieVersion(!0)?this.getValueStripped():this.getValuePlain();if(!a)return!0;a=a.replace(/^(\s|\xA0)+|(\s|\xA0)+$/mg,"");return!a||0==a.length},hasValueChanged:function(){return this._valueOriginal!=this.getValue()},isToolbarHidden:function(){return this._options&&
this._options.toolbar&&this._options.toolbar.hide},manuallyInit:function(){m||this._ifloaded||q||this._ifload()},setText:function(a){this.setValue(a)},setValue:function(a){this._setValueInternal(a)},_setValueInternal:function(a,b){var c=document.createElement("div");c.innerHTML=a||"";this._valueSet=c.innerHTML;if(c=juic.$(this.id))m?c.innerHTML=this._valueSet:c.contentDocument&&c.contentDocument.body?c.contentDocument.body.innerHTML=this._valueSet:q&&(c.value=this._valueSet),this._options.name&&(c=
juic.$(this._options.name))&&(c.value=this._valueSet),1!=b&&this._update()},setValuePlain:function(a){this.setValue(this._txtEscEntities(a))},getEditorDocument:function(){var a,b=juic.$(this.id);a=m?b:(a=b.contentWindow)&&a.document||b.contentDocument;return a},renderHtml:function(a){this._allowResize?this._super(a):this.renderContent(a)},_getA11yDescId:function(){return this._useDefaultLabel?this._gname+"_RTEditorDesc":"rteditor508Desc"},renderContent:function(a){function b(b){if(!b||k._paneWidth&&
h+26+8>k._paneWidth)return 0;h+=26;a.push("\x3cli class\x3d'nrte_toolbar_button_li'\x3e");b.renderHtml(a);a.push("\x3c/li\x3e");return 1}function c(b){if(k._paneWidth&&h+52+8>k._paneWidth)return 0;h+=52;a.push("\x3cli class\x3d'nrte_toolbar_button_li'\x3e");b.renderHtml(a);a.push("\x3c/li\x3e");return 1}function d(){if(k._paneWidth&&h+9+8>k._paneWidth)return 0;h+=9;a.push("\x3cli class\x3d'nrte_toolbar_sep_li'\x3e|\x3c/li\x3e");return 1}var e=this.id;if(q)a.push('\x3cdiv id\x3d"iPadMsg"\x3e',MSGS.COMMON_RTE_NOT_SUPPORTED,
"\x3c/div\x3e"),a.push('\x3ctextarea id\x3d"',e,'" class\x3d"iPadRTE" disabled\x3e',this._valueSet,"\x3c/textarea\x3e");else{var f=this._getA11yDescId();juic.$(f)||a.push("\x3cspan id\x3d'",f,"' class\x3d'hiddenAriaContent'\x3e",this._label,"\x3c/span\x3e");var g=this._tb,k=this,h=0;a.push("\x3cdiv  id\x3d'",this.registerAutomationName(this.id+"_wrapper","RTEditor-"+this._gname),"' onclick\x3d'",this.fireCode("_eventClick"),"'"," style\x3d'");this._options.absolutePosition&&(a.push("position:absolute;"),
this._options.absolutePosition.left&&a.push("left:",this._options.absolutePosition.left,"px;"),this._options.absolutePosition.top&&a.push("top:",this._options.absolutePosition.top,"px;"));a.push("height:",this._options.height-2*this._DEFAULT_RTE_BORDER_WIDTH,"px;");a.push("border-width:1px;");this._paneWidth&&a.push("width:",this._paneWidth-2*this._DEFAULT_RTE_BORDER_WIDTH,"px;");this._getOptTextpaneBorderColor()&&a.push("border-color:",this._getOptTextpaneBorderColor(),";");this._getOptTextpaneBorderStyle()&&
a.push("border-style:",this._getOptTextpaneBorderStyle(),";");a.push("' role\x3d'application' aria-labelledby\x3d'",f,"'\x3e");if(!this.isToolbarHidden()&&!this.isReadOnly()){a.push("\x3cdiv class\x3d'nrte_toolbar_div' style\x3d'");this._getOptToolbarBackground()&&a.push("background:",this._getOptToolbarBackground(),";");this._getOptToolbarBorderColor()&&a.push("border-color:",this._getOptToolbarBorderColor(),";");a.push("height:",this._DEFAULT_TOOLBAR_HEIGHT-this._DEFAULT_RTE_BORDER_WIDTH,"px;");
a.push("'\x3e");a.push("\x3cdiv class\x3d'toolbarULDiv'\x3e");a.push("\x3cul role\x3d'toolbar'"," unselectable\x3d'on' ondragstart\x3d'javascript:return 0'"," id\x3d'",e,"_toolbar' class\x3d'nrte_toolbar_div_ul'");p?a.push(" onmousedown\x3d'",this.fireCode("_saveSelection"),"'"):10>=Util.ieVersion()?a.push(" onmousedown\x3d'",this.fireCode("_saveParentScrollTop"),"'"):a.push(" onmousedown\x3d'javascript:return 0'");a.push("\x3e");b(g.bold)&&b(g.italic)&&b(g.underline)&&d()&&b(g.numbers)&&b(g.bullets)&&
b(g.outdent)&&b(g.indent)&&d()&&b(g.createLink)&&d()&&b(g.textColor)&&c(g.fontSize)&&d();var l=!1;b(g.spellCheck)&&(l=!0);b(g.legalScan)&&(l=!0);b(g.waca)&&(l=!0);this._options&&this._options.notebook&&b(g.notebook)&&(l=!0);l&&d();g="RTEditor.attachTBBtnEvent('"+e+"_toolbar')";a.push("\x3c/ul\x3e");a.push("\x3c/div\x3e");a.push('\x3cimg src\x3d"'+IMAGES["/ui/juic/img/_.gif"]+'" onerror\x3d"',g,'"  onload\x3d"',g,'" style\x3d"width:0;height:0;"/\x3e\x3c/div\x3e')}m?(g="nrte_showScrollbar",p&&(g+=" nrte_content_webkit"),
a.push("\x3cdiv class\x3d'",g,"' style\x3d'padding:",this._DEFAULT_TEXTPANE_PADDING,"px;","border:0px;"),this._getOptTextpaneBackground()&&a.push("background:",this._getOptTextpaneBackground(),";"),this._paneHeight&&a.push("height:",this._getEditorHeight(),"px;"),p&&(this._getOptTextpaneFontFamily()&&a.push("font-family:",this._getOptTextpaneFontFamily(),";"),this._getOptTextpaneFontSize()&&a.push("font-size:",this._getOptTextpaneFontSize(),";")),a.push("'"," onclick\x3d'",this.fireCode("_eventClickTextPane"),
"'"),p?a.push(" id\x3d'",e,"'"):(a.push(" id\x3d'",e,"_editor'\x3e",'\x3cdiv class\x3d"nrte_content" id\x3d\'',e,"' style\x3d'"),this._getOptTextpaneFontFamily()&&a.push("font-family:",this._getOptTextpaneFontFamily(),";"),this._getOptTextpaneFontSize()&&a.push("font-size:",this._getOptTextpaneFontSize(),";"),a.push("'")),a.push(" aria-labelledby\x3d'",f,"'"),this.isReadOnly()||a.push(" contenteditable\x3d'true'"),a.push(" onblur\x3d'",this.fireCode("_blur"),"'"," onkeyup\x3d'",this.fireCode("_keyup"),
"'"," ondblclick\x3d'",this.fireCode("_update"),"'"," onmouseup\x3d'",this.fireCode("_update"),"'"," onpaste\x3d'",this.fireCode("_paste"),"'"," oncut\x3d'",this.fireCode("_update"),"'"," onfocus\x3d'",this.fireCode("_focus"),"'","\x3e",this._valueSet,"\x3c/div\x3e"),p||a.push("\x3c/div\x3e")):(a.push("\x3ciframe id\x3d'",e,"' style\x3d'"),this._paneHeight&&a.push("height:",this._getEditorHeight(),"px;"),a.push("width:100%;"),a.push("-moz-box-sizing:border-box;"),a.push("border:0px; '"),this._options&&
this._options.manuallyInit||a.push(" onload\x3d'",this.fireCode("_ifload"),"'"),a.push(" title\x3d'",this._label,"'"),a.push(" src\x3d'javascript:\"loading...\";'\x3e"),a.push("\x3c/iframe\x3e"));this._options.name&&a.push("\x3cinput type\x3d'text' style\x3d'display: none;' id\x3d'",this._options.name,"' name\x3d'",this._options.name,"' value\x3d'",this._valueSet.replace(/&/g,"\x26amp;").replace(/\'/g,"\x26#39;").replace(/</g,"\x26lt;"),"'\x3e");this._textLimiter&&(a.push('\x3cdiv id\x3d"',this.id,
'_counter" class\x3d"nrte_char_textLimiter nrte_char_hideLimiter" \x3e'),this._textLimiter.renderHtml(a),a.push('\x3c/div\x3e\x3cdiv class\x3d"nrte_clearDiv"\x3e\x3c/div\x3e'));a.push("\x3c/div\x3e")}},_updateHiddenInput:function(){this._options.name&&(juic.$(this._options.name).value=this.getValue())},_blur:function(){this._hideTextLimiter();this._updateHiddenInput();this.dispatch("blur")},_eventClick:function(){this.dispatch("click")},_eventClickTextPane:function(){if(!p){var a=document.activeElement;
a&&a.id&&a.id==this.id||this._refocus()}this._tb.textColor.hideDisplay()},_eventClickIFrame:function(){this._eventClickTextPane();this._eventClick();this.dispatch("clickIFrame")},_execCommand:function(a,b,c){if("_popUpSpellCheck"==a)return this._popUpSpellCheck();if("_popUpLegalScan"==a)return this._popUpLegalScan();if("_popUpWACA"==a)return this._popUpWACA();if("_notebook"==a)return this._notebook();var d=document.activeElement;d&&d.id&&d.id==this.id||this._refocus();if(b&&"createLink"==a&&(!Util.ieVersion(!0)||
Util.browserInfo.edge)){b=juic.$(this.id);m?d=window.getSelection():(b=b.contentDocument,d=b.getSelection());c=MSGS.COMMON_RTE_HYPERLINK_HTTP;if(d&&d.focusNode){d=d.focusNode;if(Util.browserInfo.edge)for(;d.childNodes&&d.childNodes[0];)d=d.childNodes[0];if(SFDom.isAncestor(b,d))for(;d.parentNode&&d.parentNode!=b;){if("a"==d.parentNode.tagName.toLowerCase()){c=d.parentNode.getAttribute("href");break}d=d.parentNode}}c=prompt(MSGS.COMMON_RTE_HYPERLINK_URL,c);if(!c)return;null==/^(https?:)?\/\/.*/i.exec(c)&&
(c=MSGS.COMMON_RTE_HYPERLINK_HTTP+c);b=!1}m?document.execCommand(a,b,c):juic.$(this.id).contentDocument.execCommand(a,b,c);this._checkCount()||this._update()},_getBackPosLegalScan:function(){return this._options&&this._options.legalScan?-(18*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT):-(19*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT)},_getBackPosNotebook:function(){return this._options&&this._options.notebook?-(23*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT):-(24*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT)},_getBackPosSpellCheck:function(){return this._options&&
this._options.spellCheck?-(16*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT):-(17*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT)},_getBackPosWACA:function(){return this._options&&this._options.waca?-(20*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT):-(21*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT)},_getOptTextpaneBorderColor:function(){return this._options&&this._options.textpane&&this._options.textpane.border&&this._options.textpane.border.color?this._options.textpane.border.color:this._DEFAULT_TEXTPANE_BORDER_COLOR},_getOptTextpaneBorderStyle:function(){return this._options&&
this._options.textpane&&this._options.textpane.border&&this._options.textpane.border.style?this._options.textpane.border.style:this._DEFAULT_TEXTPANE_BORDER_STYLE},_getOptTextpaneBackground:function(){return this._options&&this._options.textpane&&this._options.textpane.background?this._options.textpane.background:null},_getOptTextpaneFontFamily:function(){return this._options&&this._options.textpane&&this._options.textpane.fontFamily},_getOptTextpaneFontSize:function(){return this._options&&this._options.textpane&&
this._options.textpane.fontSize},_getOptToolbarBackground:function(){return this._options&&this._options.toolbar&&this._options.toolbar.background?this._options.toolbar.background:this._DEFAULT_TOOLBAR_BACKGROUND},_getOptToolbarBorderColor:function(){return this._options&&this._options.toolbar&&this._options.toolbar.border&&this._options.toolbar.border.color?this._options.toolbar.border.color:this._DEFAULT_TOOLBAR_BORDER_COLOR},_getOptToolbarBorderStyle:function(){return this._options&&this._options.toolbar&&
this._options.toolbar.border&&this._options.toolbar.border.style?this._options.toolbar.border.style:this._DEFAULT_TOOLBAR_BORDER_STYLE},_getOptToolbarButtonsBorderColor:function(){return this._options&&this._options.toolbar&&this._options.toolbar.buttons&&this._options.toolbar.buttons.border&&this._options.toolbar.buttons.border.color?this._options.toolbar.buttons.border.color:null},_getOptToolbarSub:function(){return this._options&&this._options.toolbar&&this._options.toolbar.sub?this._options.toolbar.sub:
null},_ifload:function(){var a=juic.$(this.id).contentDocument;a.body.innerHTML=this._valueSet;this.isReadOnly()||a.body.setAttribute("contenteditable","true");Util.isRTL()&&a.body.setAttribute("dir","rtl");a.body.style.padding=""+this._DEFAULT_TEXTPANE_PADDING+"px";a.body.style.margin="0px";"dark"==AccessibilityPrefs.getLowVisionType()&&(a.body.style.color="#ffffff");this._getOptTextpaneBackground()&&(a.body.style.background=this._getOptTextpaneBackground());this._getOptTextpaneFontFamily()&&(a.body.style.fontFamily=
this._getOptTextpaneFontFamily());this._getOptTextpaneFontSize()&&(a.body.style.fontSize=this._getOptTextpaneFontSize());a.addEventListener("click",l(this,this._eventClickIFrame),!1);if(!this.isReadOnly()){try{a.designMode="on";try{a.execCommand("styleWithCSS",0,!1)}catch(c){try{a.execCommand("useCSS",0,!0)}catch(d){try{a.execCommand("styleWithCSS",!1,!1)}catch(e){}}}}catch(c){throw c;}var b=this;a.addEventListener("blur",l(this,this._blur),!0);a.addEventListener("keydown",function(a){function c(c){!a.ctrlKey||
a.shiftKey||a.altKey||a.metaKey||(juic.$(b.id).contentDocument.execCommand(c,!1,null),a.preventDefault(),a.stopPropagation())}switch(a.keyCode){case 9:a.preventDefault();if(a.shiftKey)if(b._tb){var e=b._tb;e.waca?juic.$("link_icon_"+e.waca.id).focus():e.legalScan?juic.$("link_icon_"+e.legalScan.id).focus():e.spellCheck?juic.$("link_icon_"+e.spellCheck.id).focus():e.fontSize?juic.$(e.fontSize.dropdown.id).focus():e.textColor?juic.$("link_icon_"+e.textColor.id).focus():e.createLink?juic.$("link_icon_"+
e.createLink.id).focus():e.outdent?juic.$("link_icon_"+e.outdent.id).focus():e.indent?juic.$("link_icon_"+e.indent.id).focus():e.bullets?juic.$("link_icon_"+e.bullets.id).focus():e.numbers?juic.$("link_icon_"+e.numbers.id).focus():e.underline?juic.$("link_icon_"+e.underline.id).focus():e.italic?juic.$("link_icon_"+e.italic.id).focus():e.bold&&juic.$("link_icon_"+e.bold.id).focus()}else try{juic.$(b.id).focus()}catch(k){}else{for(var e=document.body,f=b._getRTEParentNode(),g=f.nextSibling;!g;){f=f.parentNode;
if(!f||f==e)break;g=f.nextSibling}if((f=g?SFDom.findNextFocusableElement(g,e,!0,!1):null)&&f.focus)try{f.focus()}catch(k){f=null}f||e.focus()}break;case 66:c("bold");break;case 73:c("italic");break;case 85:c("underline")}},!0);a.addEventListener("keyup",l(this,this._keyup),!0);a.addEventListener("mouseup",l(this,this._update),!0);a.addEventListener("paste",l(this,this._paste),!0);a.addEventListener("cut",l(this,this._update),!0);a.addEventListener("focus",l(this,this._focus),!0);this._ifloaded=!0}},
_getRTEParentNode:function(){var a=juic.$(this.id+"_wrapper").parentNode;this._allowResize&&(a=a.parentNode);return a},_focus:function(){this._textLimiter&&(this._textLimiter.checkLimiter(this.getValue()),this._showTextLimiter());this._allowAutoGrow&&this._resizeForAutoGrow();this.dispatch("focus")},_notebook:function(){juic.assert(this._options&&this._options.notebook,"Notebook configuration not specified.");this._options.notebook.event&&this.dispatch(this._options.notebook.event)},_secureForm:function(a){return a+
"_s.crb\x3d"+ajaxSecKey},_popUpSpellCheck:function(){var a=this.getValueEscaped(),b=[];b.push("\x3chtml\x3e\n");b.push("\x3chead\x3e\n");b.push("\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html; charset\x3dutf-8'\x3e\n");b.push("\x3c/head\x3e\n");b.push("\x3cbody\x3e\n");b.push("\x3cfont face\x3d'arial, helvetica' size\x3d2\x3e",RTEditor.msgs.COMMON_RTE_SPELL_CHECK_DOCUMENT,"\x3c/font\x3e\n");b.push("\x3cform action\x3d'"+this._secureForm("/ui/uicore/pages/rapidspellcheck?")+"' method\x3d'post' ACCEPT-CHARSET\x3d'UTF-8'\x3e\n");
b.push("\x3cinput type\x3d'hidden' name\x3d'textToCheck' value\x3d\"");b.push(a);b.push('"\x3e\n');b.push("\x3cinput type\x3d'hidden' name\x3d'InterfaceObject' value\x3d'");b.push(this._gname);b.push("'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'mode' value\x3d'popup'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'UserDictionaryFile' value\x3d''\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'SuggestionsMethod' value\x3d'HASHING_SUGGESTIONS'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'SeparateHyphenWords' value\x3d'true'\x3e\n");
b.push("\x3cinput type\x3d'hidden' name\x3d'IncludeUserDictionaryInSuggestions' value\x3d'true'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'FinishedListener' value\x3d''\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'callBack' value\x3d''\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'IgnoreXML' value\x3d'true'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'IgnoreCapitalizedWords' value\x3d'false'\x3e\n");a=window.localeForRapidSpellWeb?window.localeForRapidSpellWeb:window.userSelectedLanguage?
window.userSelectedLanguage:"ENGLISH";b.push("\x3cinput type\x3d'hidden' name\x3d'GuiLanguage' value\x3d'");b.push(a);b.push("'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'LanguageParser' value\x3d'");b.push(a);b.push("'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'Modal' value\x3d'false'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'AllowAnyCase' value\x3d'false'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'IgnoreWordsWithDigits' value\x3d'false'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'ShowFinishedMessage' value\x3d'true'\x3e\n");
b.push("\x3cinput type\x3d'hidden' name\x3d'ShowNoErrorsMessage' value\x3d'true'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'ShowXMLTags' value\x3d'false'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'AllowMixedCase' value\x3d'false'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'WarnDuplicates' value\x3d'true'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'DictFile' value\x3d''\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'PopUpWindowName' value\x3d''\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'CreatePopUpWindow' value\x3d'true'\x3e\n");
b.push("\x3cinput type\x3d'hidden' name\x3d'ConsiderationRange' value\x3d'80'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'UseUpdate' value\x3d'false'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'LookIntoHyphenatedText' value\x3d'true'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'CheckCompoundWords' value\x3d'false'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'EnableUndo' value\x3d'true'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'LeaveWindowOpenForUndo' value\x3d'false'\x3e\n");
b.push("\x3cinput type\x3d'hidden' name\x3d'FinishClosesWindow' value\x3d'true'\x3e\n");b.push("\x3c/form\x3e\n");b.push(r());b.push("\x3c/body\x3e\n");b.push("\x3c/html\x3e\n");this._popUpWin("rspellnwin","spell checker",b.join(""),{width:370,height:515})},_popUpLegalScan:function(){var a=this.getValueEscaped(),b=[];b.push("\x3chtml\x3e\n");b.push("\x3chead\x3e\n");b.push("\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html; charset\x3dutf-8'\x3e\n");b.push("\x3c/head\x3e\n");b.push("\x3cbody\x3e\n");
b.push("\x3cfont face\x3d'arial, helvetica' size\x3d2\x3e",RTEditor.msgs.COMMON_RTE_SCANNING_DOCUMENT,"\x3c/font\x3e\n");b.push("\x3cform action\x3d'"+this._secureForm("/legalscan?")+"' method\x3d'post' ACCEPT-CHARSET\x3d'UTF-8'\x3e\n");b.push("\x3cinput type\x3d'hidden' name\x3d'lscn_param_fieldvalue' value\x3d\"");b.push(this._txtEscQuotes(a));b.push('"\x3e\n');b.push("\x3c/form\x3e\n");b.push(r());b.push("\x3c/body\x3e\n");b.push("\x3c/html\x3e\n");this._popUpWin("legalscanwin","legal scanner",
b.join(""))},_popUpWACA:function(){juic.assert(this._options&&this._options.waca,"Writing assistant configuration not specified.");this.getValueEscaped();var a=[];a.push("\x3chtml\x3e\n");a.push("\x3chead\x3e\n");a.push("\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html; charset\x3dutf-8'\x3e\n");a.push("\x3c/head\x3e\n");a.push("\x3cbody\x3e\n");a.push("\x3cfont face\x3d'arial, helvetica' size\x3d2\x3e",RTEditor.msgs.COMMON_RTE_INIT_WACA_DOCUMENT,"\x3c/font\x3e\n");a.push("\x3cform action\x3d'"+
this._secureForm("/handbook?")+"' method\x3d'post' ACCEPT-CHARSET\x3d'UTF-8'\x3e\n");a.push("\x3cinput type\x3d'hidden' name\x3d'hbpge_param_hbnavtab' value\x3d'hb_all'\x3e\n");a.push("\x3cinput type\x3d'hidden' name\x3d'hbpge_sh_wri' value\x3d'true'\x3e\n");a.push("\x3cinput type\x3d'hidden' name\x3d'hbpge_sh_coa' value\x3d'true'\x3e\n");this._options.waca.competencyId&&a.push("\x3cinput type\x3d'hidden' name\x3d'hball_param_compid' value\x3d'",this._options.waca.competencyId,"'\x3e\n");a.push("\x3cinput type\x3d'hidden' name\x3d'hball_param_complocale' value\x3d'",
this._options.waca.competencyLocale?this._options.waca.competencyLocale:"en_US","'\x3e\n");this._options.waca.employeeId&&a.push("\x3cinput type\x3d'hidden' name\x3d'hbpge_param_sub_id' value\x3d'",this._options.waca.employeeId,"'\x3e\n");a.push("\x3cinput type\x3d'hidden' name\x3d'rte' value\x3d'true'\x3e\n");a.push("\x3cinput type\x3d'hidden' name\x3d'fbwaca_param_rte_gname' value\x3d'");a.push(this._gname);a.push("'\x3e\n");a.push("\x3cinput type\x3d'hidden' name\x3d'fbwaca_param_rte_sufx' value\x3d'\x3cbr\x3e\x3cbr\x3e'\x3e\n");
a.push("\x3c/form\x3e\n");a.push(r());a.push("\x3c/body\x3e\n");a.push("\x3c/html\x3e\n");this._popUpWin("wacawin","writing assistant",a.join(""),{width:740,height:580})},_popUpWin:function(a,b,c,d){var e=370,f=430;null!=d&&null!=d.width&&(e=d.width);null!=d&&null!=d.height&&(f=d.height);(a=this._rsw_create_popup_window("/ui/uicore/pages/blank.html",a,"resizable\x3dyes,scrollbars\x3dyes,dependent\x3dyes,toolbar\x3dno,left\x3d100,top\x3d100,status\x3dno,location\x3dno,menubar\x3dno,width\x3d"+e+",height\x3d"+
f))?(a.focus(),a.document.open(),a.document.write(c),a.document.close()):alert("The "+b+" popup has been blocked, most likely by a popup blocker.")},_refocus:function(){var a=juic.$(this.id);if(m){if(a.focus(),10>=Util.ieVersion()&&this._parentScrollTop){var b=this;setTimeout(function(){a.parentNode.scrollTop=b._parentScrollTop;delete b._parentScrollTop},1)}}else a.contentWindow.focus();if(this._savedRange){var c=window.getSelection();c.removeAllRanges();c.addRange(this._savedRange);delete this._savedRange}},
_rsw_create_popup_window:function(a,b,c){var d;if(window.showModelessDialog){var e;try{(e=window.dialogArguments||window.opener)&&e!=window&&!e.closed&&(d=e.open(a,b,c))&&(d.opener=window)}catch(f){e=null}e||(d=window.open(a,b,c),d.opener=window)}else d=window.open(a,b,c);return d},_saveParentScrollTop:function(){this._parentScrollTop=juic.$(this.id).parentNode.scrollTop},_saveSelection:function(){var a=juic.$(this.id);if(a){var b=m?window:a.contentWindow,c=b.document,a=m?a:c.body;if(window.getSelection&&
document.createRange){var d;if(p)try{var e=b.getSelection();e.rangeCount&&e.getRangeAt&&(d=e.getRangeAt(0))&&(e.removeAllRanges(),e.addRange(d))}catch(f){return{start:0,end:0}}else d=b.getSelection().getRangeAt(0);this._savedRange=d;b=d.cloneRange();b.selectNodeContents(a);b.setEnd(d.startContainer,d.startOffset);a=b.toString().length;return{start:a,end:a+d.toString().length}}d=document.selection.createRange();b=document.body.createTextRange();b.moveToElementText(a);b.setEndPoint("EndToStart",d);
a=b.text;b=a.match(/\r\n/g);a=a.length-(b?b.length:0);return{start:a,end:a+d.text.length}}},_restoreSelection:function(a,b){var c=juic.$(this.id);if(c){var d=(m?window:c.contentWindow).document,e=m?c:d.body;if(window.getSelection&&document.createRange){d=0;c=document.createRange();c.setStart(e,0);c.collapse(!0);for(var e=[e],f,g=!1,k=!1;!k&&(f=e.pop());)if(3==f.nodeType){var h=d+f.length;!g&&a.start>=d&&a.start<=h&&(a.start!=h||!b)&&(c.setStart(f,a.start-d),g=!0);g&&a.end>=d&&a.end<=h?(c.setEnd(f,
a.end-d),k=!0):g&&0==e.length&&(c.setEnd(f,h-d),k=!0);d=h}else for(h=f.childNodes.length;h--;)e.push(f.childNodes[h]);f=m?window.getSelection():juic.$(this.id).contentWindow.getSelection();f.removeAllRanges();f.addRange(c)}else{f=document.body.createTextRange();f.moveToElementText(e);f.collapse(!0);c=a.start;d=a.end;try{b&&(a.end==a.start&&a.start++,a.end++),f.moveEnd("character",a.end),f.moveStart("character",a.start),f.select()}catch(x){f.moveEnd("character",c),f.moveStart("character",d),f.select()}}}},
_togglePalette:function(){var a=juic.$(this.id+"pal").style;a.display=""==a.display?"block":""},_txtEscQuotes:function(a){return a?a.replace(RegExp('"',"g"),"\x26#34;"):null},_txtEscEntities:function(a){if(!a)return null;var b=RegExp("\x26","g");a=a.replace(b,"\x26amp;");for(var c=161;255>=c;c++)b=new RegExp(String.fromCharCode(c),"g"),a=a.replace(b,"\x26#"+c+";");return a},_txtTranslateHTML:function(a){if(!a)return null;var b=document.createElement("div");b.innerHTML=a;return SFDom.text(b)},_txtUnEscEntitiesWithLinkBreaks:function(a){if(!a)return null;
a=a.replace(/\r/g,"").replace(/\n/g,"");a=a.replace(/<div(\s+((\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*))?>(.*?)<\/\s*div>/gi,"\n$6");a=a.replace(/<li(\s+((\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*))?>(.*?)<\/\s*li>/gi,"\n$6\n");a=a.replace(/<br(\s+((\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*))?>/gi,"\n");a=a.replace(/<p(\s+((\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*))?>(.*?)<\/\s*p>/gi,"\n$6\n\n");a=a.replace(/<p(\s+((\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*))?>/gi,
"\n\n");a=a.replace(/<(\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*>/g,"");return this._txtUnEscEntities(a)},_txtUnEscEntities:function(a){if(!a)return null;var b=function(a){var b=document.createElement("div");b.innerHTML=a;a=b.childNodes[0].nodeValue;b.removeChild(b.firstChild);return a},c=a.match(/&(.*?);/g);if(c&&c.length)for(var d=0;d<c.length;++d){var e=c[d];e&&(a=a.replace(new RegExp(e,"g"),b(e)))}return a},_keyup:function(a){var b=this._options.bubbleUpdateEventOnKeyup||!1;if(a){if(!a.ctrlKey&&
!this._ctrlKeyPressedEarlier){var c=SFDOMEvent.KEY_CODE;switch(a.keyCode){case c.CTRL:case c.ARROW_LEFT:case c.ARROW_UP:case c.ARROW_RIGHT:case c.ARROW_DOWN:break;default:this._updateHiddenInput(),this._update(b,a),this._pasteValue=null}}}else this._updateHiddenInput(),this._update(b);this._allowAutoGrow&&this._resizeForAutoGrow()},_resizeForAutoGrow:function(){var a=this._DEFAULT_TOOLBAR_HEIGHT,b=2*this._DEFAULT_RTE_BORDER_WIDTH,c=2*this._DEFAULT_TEXTPANE_PADDING,d=juic.$(this.id+"_wrapper"),e=juic.$(this.id+
"_editor");e||(e=juic.$(this.id));if(m){SFDom.replaceClass(e,"nrte_showScrollbar","nrte_hideScrollbar");var f=e.scrollHeight+a+b;f<this._autoGrow_maxHeight?d.style.height=f-b+"px":(d.style.height=this._autoGrow_maxHeight-b+"px",SFDom.replaceClass(e,"nrte_hideScrollbar","nrte_showScrollbar"));e.style.height=parseInt(d.style.height)-a-c+"px"}else f=e.contentDocument.body.scrollHeight+a+b,e.contentDocument.body.style.overflow="hidden",f<this._autoGrow_maxHeight?d.style.height=f-b+"px":(d.style.height=
this._autoGrow_maxHeight-b+"px",e.contentDocument.body.style.overflow="auto"),e.style.height=parseInt(d.style.height)-a+"px"},_update:function(a,b){if(!q&&!this.isReadOnly()&&(m||this._ifloaded)){var c=juic.$(this.id),d=this._tb;a&&(c&&(c=m?document:c.contentDocument,d.bold.setActive(c.queryCommandState("bold")),d.italic.setActive(c.queryCommandState("italic")),d.underline.setActive(c.queryCommandState("underline")),d.numbers.setActive(c.queryCommandState("insertorderedlist")),d.bullets.setActive(c.queryCommandState("insertunorderedlist")),
d.fontSize.setValue(c.queryCommandValue("fontSize"))),this.dispatch("change"));if(this._textLimiter)if(this._highlightOverflowTextMode){if(7<=Util.ieVersion()){if(b&&"dblclick"==b.type){this.isDoubleClick=!0;return}if(b&&"mouseup"==b.type){if(this.isDoubleClick){this.isDoubleClick=!1;return}this.isDoubleClick=!1}}var e=this._removeHighlightStyles(this.getValue()),c=this._textLimiter.getCheckLimiterObject(e);if(c.actionCommand==SFTextLimiter.ABOVE_MAXLENGTH||c.actionCommand==SFTextLimiter.AT_MAXLENGTH){if(!(10>
Util.ieVersion())){var f=this._saveSelection();this._setValueInternal(e,!0);var d=this._options.maxChars,g=e.length;window.getSelection&&document.createRange||(e=this._txtUnEscEntities(e).length,g>e&&(g=e,d>g&&(d=g)));this._addHighlightStyles(d,g)}10>Util.ieVersion()||this._restoreSelection(f,b&&(b.keyCode==SFDOMEvent.KEY_CODE.RETURN||b.keyCode==SFDOMEvent.KEY_CODE.ARROWDOWN))}this._textLimiter._updateView(c)}else this._textLimiter.checkLimiter(this.getValue())}},isOverTextCountLimit:function(){if(this._textLimiter&&
this._highlightOverflowTextMode){var a=this._removeHighlightStyles(this.getValue());if(this._textLimiter.getCheckLimiterObject(a).actionCommand==SFTextLimiter.ABOVE_MAXLENGTH)return!0}return!1},textLimiterAutoTrim:function(a){if(this._textLimiter&&this._maxLength&&this._textLimiter.getByteLength(this.getValue())>this._maxLength){var b=10;do this._setValueInternal(this.getValue().slice(0,this._maxLength-1-b)),b+=10;while(this._textLimiter.getByteLength(this.getValue())>this._maxLength);this._prevValue=
b=this.getValue();!a&&this._options.name&&(a=juic.$(this._options.name))&&(a.value=b)}},_removeHighlightStyles:function(a){return a.replace(/<span\sstyle=\"background-color:\srgb\(255\,\s204\,\s204\)\;\">(.*?)<\/span>/gi,"$1").replace(/<font\sstyle=\"background-color:\srgb\(255\,\s204\,\s204\)\;\">(.*?)<\/font>/gi,"$1").replace(/<font\sstyle=\"background-color:\s#fcc*\">(.*?)<\/font>/gi,"$1")},_addHighlightStyles:function(a,b,c){c=c?c:RTEditor.DEFAULT_HIGHLIGHT_BG_COLOR;juic.$(this.id);this._restoreSelection({start:a,
end:b});window.getSelection&&document.createRange?v?juic.$(this.id).contentDocument.execCommand("hiliteColor",!1,c):document.execCommand("backColor",!1,c):document.execCommand("backColor",!1,c)},_showTextLimiter:function(){this._highlightOverflowTextMode?this._textLimiter.show():this._isLimiterDIVVisible&&this._textLimiter.show()},_hideTextLimiter:function(){this._highlightOverflowTextMode?this._checkCount(!1)&&this._textLimiter.hide():this._isLimiterDIVVisible&&this._textLimiter.hide()},_handleLimiterEvent:function(a){if(!this._highlightOverflowTextMode)if(juic.$(this.id+
"_counter"),this._isLimiterDIVVisible=!1,a.actionCommand==SFTextLimiter.BELOW_THRESHOLD)this._prevValue=this.getValue(),this._textLimiter.hide();else{if(a.actionCommand==SFTextLimiter.ABOVE_MAXLENGTH){if(this._setValueInternal(this._prevValue),!this._dialogVisible)if(this._options.maxCharWarning)this._pasteValue&&(this._dialogVisible=!0,juic.$(this.id)&&juic.$(this.id).blur(),this._pasteValue=null,this._pasteLimitDialog.showDialog(this.id));else if(this._dialogVisible=!0,juic.$(this.id)&&juic.$(this.id).blur(),
this._pasteValue&&this._pasteValue.length>this._maxLength){a=10;do this._setValueInternal(this._pasteValue.slice(0,this._maxLength-1-a),!0),a+=10;while(this._textLimiter.getByteLength(this.getValue())>this._maxLength);this._pasteValue=null;this._pasteLimitDialog.showDialog(this.id)}else this._charLimitDialog&&this._charLimitDialog.showDialog(this.id)}else this._isLimiterDIVVisible=!0,this._prevValue=this.getValue();this._showTextLimiter()}},_resetValue:function(){this._textLimiter&&this._textLimiter.checkLimiter(this.getValue())},
_checkCount:function(a){if(!this._textLimiter)return!0;var b=this._removeHighlightStyles(this.getValue());this._textLimiter.checkLimiter(b);b=this._textLimiter.getByteLength(b);return this._textLimiter&&(a?b<=this._maxLength:b<this._maxLength)?!0:!1},_paste:function(){var a=this;juic.$(a.id);this._ctrlKeyPressedEarlier=!0;setTimeout(function(){a._ctrlKeyPressedEarlier=!1},50);setTimeout(function(){a._pasteValue=a.getValue();if(a._textNeedsCleaningUp(a._pasteValue)){var b=!0;a._options.cleanUpTextOnPasteConfirm&&
(b=confirm(MSGS.get("COMMON_RTE_PASTE_FROM_WORD_DEFAULT")));b&&(a._pasteValue=a._cleanUpPastedText(a._pasteValue),a._setValueInternal(a._pasteValue))}a._update()},1)},_textNeedsCleaningUp:function(a){return/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(a)},_wordListToHTMLList:function(a){for(var b,c="",d=[],e="none",f=0;a.substring(f,a.length).match(/<p[^>]*mso-list\:[\s\S]+?<\/p>/mi);){b=a.substring(f,a.length).match(/<p[^>]*mso-list\:[\s\S]+?<\/p>/mi);b=b[0];var f=f+a.substring(f,a.length).indexOf(b),
g=f+b.length,k=b.match(/\s*font-family\:\s*Symbol\s*/im)&&1===b.match(/\s*font-family\:\s*Symbol\s*/im).length?"ul":"ol",h="\x3cli\x3e";if("none"===e||k!==e)h="ul"===k?"\x3cul\x3e"+h:"\x3col\x3e"+h,e=k;b=b.replace(/<p[^>]*mso-list\:[\s\S]+?>(.*)<\/p>/ig,"$1");9>Util.ieVersion()&&(b=b.replace(/<span[^>]*mso-list\:[\s\S]+?>[\s\S]+?<\/span>/gi,""));b=b.replace(/<\/span>+/gi,"");b=b.replace(/<span([^>]*)>/gi,"");d.push({start:f,end:g,originalContent:b,newTagStart:h,newTagEnd:"\x3c/li\x3e",type:k});f=
g}for(e=f=0;e<d.length;e++)c+=a.substring(f,d[e].start)+d[e].newTagStart+d[e].originalContent+d[e].newTagEnd,d[e+1]&&d[e+1].type!==d[e].type&&(c+="\x3c/"+d[e].type+"\x3e"),f=d[e].end;0<e&&(c+="\x3c/"+d[e-1].type+"\x3e");return c+=a.substring(f,a.length)},_cleanUpPastedText:function(a){var b=a;Util.browserInfo.ie11plus||(b=this._wordListToHTMLList(a));b=b.replace(/<img[^>]+>/gi,"");b=b.replace(/<w:[^>]*>[^>]*<\/w:[^>]*>/gi,"");b=b.replace(/<o:[^>]*>[^>]*<\/o:[^>]*>/gi,"");b=b.replace(/<style>(.*?)<\/style>/gi,
"");b=b.replace(/<style>[^>]*<\/style>/gi,"");b=b.replace(/\x3c!--[^>]*--\x3e/gi,"");b=b.replace(/\<\!--\[if gte mso[^>]*\]\>/gi,"");b=b.replace(/\<\!--\[if \!mso\]\>/gi,"");b=b.replace(/\<\!\[endif\]--\>/gi,"");b=b.replace(/\<\!+--*\[endif\]--\>/gi,"");b=b.replace(/\<\!+--*\[endif\]----\>/gi,"");b=b.replace(/<o:p>\s*<\/o:p>/g,"");b=b.replace(/<o:p>.*?<\/o:p>/g,"\x26nbsp;");b=b.replace(/\s*mso-[^:]+:[^;"]+;?/gi,"");b=b.replace(/\s*MARGIN: 0cm 0cm 0pt\s*;/gi,"");b=b.replace(/\s*MARGIN: 0cm 0cm 0pt\s*"/gi,
'"');b=b.replace(/\s*TEXT-INDENT: 0cm\s*;/gi,"");b=b.replace(/\s*TEXT-INDENT: 0cm\s*"/gi,'"');b=b.replace(/\s*TEXT-ALIGN: [^\s;]+;?"/gi,'"');b=b.replace(/\s*PAGE-BREAK-BEFORE: [^\s;]+;?"/gi,'"');b=b.replace(/\s*FONT-VARIANT: [^\s;]+;?"/gi,'"');b=b.replace(/\s*tab-stops:[^;"]*;?/gi,"");b=b.replace(/\s*tab-stops:[^"]*/gi,"");b=b.replace(/\s*face="[^"]*"/gi,"");b=b.replace(/\s*face=[^ >]*/gi,"");b=b.replace(/\s*FONT-FAMILY:[^;"]*;?/gi,"");b=b.replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"\x3c$1$3");
b=b.replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gi,"\x3c$1$3");b=b.replace(/\s*style="\s*"/gi,"");b=b.replace(/<SPAN\s*[^>]*>\s*&nbsp;\s*<\/SPAN>/gi,"\x26nbsp;");b=b.replace(/<SPAN\s*[^>]*><\/SPAN>/gi,"");b=b.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"\x3c$1$3");b=b.replace(/<SPAN\s*>(.*?)<\/SPAN>/gi,"$1");b=b.replace(/<\\?\?xml[^>]*>/gi,"");b=b.replace(/<\/?\w+:[^>]*>/gi,"");b=b.replace(/<H\d>\s*<\/H\d>/gi,"");b=b.replace(/<H1([^>]*)>/gi,"");b=b.replace(/<H2([^>]*)>/gi,"");b=b.replace(/<H3([^>]*)>/gi,
"");b=b.replace(/<H4([^>]*)>/gi,"");b=b.replace(/<H5([^>]*)>/gi,"");b=b.replace(/<H6([^>]*)>/gi,"");b=b.replace(/<\/H\d>/gi,"\x3cbr\x3e");b=b.replace(/<(U|I|STRIKE)>&nbsp;<\/\1>/g,"\x26nbsp;");b=b.replace(/<(B|b)>&nbsp;<\/(B|b)>/g,"");b=b.replace(/<([^\s>]+)[^>]*>\s*<\/\1>/g,"");b=b.replace(/<([^\s>]+)[^>]*>\s*<\/\1>/g,"");b=b.replace(/<([^\s>]+)[^>]*>\s*<\/\1>/g,"");b=b.replace(RegExp("(\x3cP)([^\x3e]*\x3e.*?)(\x3c/P\x3e)","gi"),"\x3cdiv$2\x3c/div\x3e");b=b.replace(/<span style="font-size\s*>(.*?)<\/span>/gi,
"$1");b=b.replace(/<p class="Mso\s*>(.*?)<\/p>/gi,"$1");return b=b.replace(/\n/g," ").replace(/\\r\\n/g," ")}})})();