function TLMManageWorkSchedulePreview(a){this.register();this.init(a)}TLMManageWorkSchedulePreview.DAYTYPE={};TLMManageWorkSchedulePreview.DAYTYPE.NO_DISPLAY="noDisplay";TLMManageWorkSchedulePreview.DAYTYPE.NOSELECTION="noSelection";TLMManageWorkSchedulePreview.DAYTYPE.DAY_OFF="dayOff";TLMManageWorkSchedulePreview.DAYTYPE.WORKING_DAY="workingDay";TLMManageWorkSchedulePreview.NUMBER_OF_DAYS=14;
juic.extend(TLMManageWorkSchedulePreview,juic.Component,{init:function(a){this._workSchedule=a.workSchedule;this._keyDate=new Date(a.keyDate.getFullYear(),a.keyDate.getMonth(),a.keyDate.getDate());this._firstBoxDate=this._getFirstDayOfWeek(this._keyDate);this._data=this._getData();this._noPreviewDisplayReason="";this.jQueryId="#"+this.id.replace(/:/g,"\\:")},_getFirstDayOfWeek:function(a){var b=window.firstDayOfWeek||0,b=a.getDay()-b;0>b&&(b=7+b);return new Date(a.getFullYear(),a.getMonth(),a.getDate()-
b)},_getData:function(){var a=[];if(0===this._workSchedule.getDays().length)return this._noPreviewDisplayReason=MSGS.get("TIMEANDLABOR_WORKSCHEDULE_PREVIEW_NO_DAYS_DEFINED"),a;this._noPreviewDisplayReason="";for(var b=this._firstBoxDate,c=0;c<TLMManageWorkSchedulePreview.NUMBER_OF_DAYS;c++){var d={};d.date=b;var e=this._getWorkScheduleDayForDate(b),e=this._workSchedule.getDays()[e];d.wsDay=e;d.date<this._keyDate?d.dayType=TLMManageWorkSchedulePreview.DAYTYPE.NO_DISPLAY:e.getCategory()===WorkScheduleDayTableItem.CATEGORY.DAY_MODEL&&
""===e.getDayModelExtCode()?d.dayType=TLMManageWorkSchedulePreview.DAYTYPE.NOSELECTION:e.getCategory()===WorkScheduleDayTableItem.CATEGORY.DAY_OFF||0===e.getHours()&&0===e.getMinutes()?d.dayType=TLMManageWorkSchedulePreview.DAYTYPE.DAY_OFF:d.dayType=TLMManageWorkSchedulePreview.DAYTYPE.WORKING_DAY;a.push(d);b=new Date(b.getFullYear(),b.getMonth(),b.getDate()+1)}return a},_getWorkScheduleDayForDate:function(a){a=this._daysBetween(this._workSchedule.getStartingDate(),a)%this._workSchedule.getDays().length;
return 0>a?a+this._workSchedule.getDays().length:a},_daysBetween:function(a,b){var c=(this._treatAsUTC(b)-this._treatAsUTC(a))/864E5;return Math.round(c)},_treatAsUTC:function(a){a=new Date(a);a.setMinutes(a.getMinutes()+a.getTimezoneOffset());return a},renderHtml:function(a){a.push('\x3cdiv id\x3d"',this.id+'_tlmWorkSchedulePreviewContent" class\x3d"tlmWorkSchedulePreview"\x3e');this._renderContent(a);a.push("\x3c/div\x3e")},_renderContent:function(a){this._renderTitleArea(a);this._noPreviewDisplayReason||
(this._renderWeekSelection(a),this._renderWeekDaysHeader(a),this._renderDays(a))},_renderTitleArea:function(a){a.push("\x3ch3\x3e");var b;this._noPreviewDisplayReason?b=this._noPreviewDisplayReason:(b=TLMFieldsHelper.UserDateFormatter.format(this._keyDate),b=MSGS.get("TIMEANDLABOR_WORKSCHEDULE_PREVIEW_TITLE",b));a.push(b);a.push("\x3c/h3\x3e")},_renderWeekSelection:function(a){var b=this._data[0].date,c=window.dateFormatSymbols.shortMonths[b.getMonth()].toUpperCase(),d=this._data[this._data.length-
1].date,e=window.dateFormatSymbols.shortMonths[d.getMonth()].toUpperCase();a.push('\x3cdiv class\x3d"weekSelectionArea"\x3e');var g=MSGS.get("TIMEANDLABOR_WORKSCHEDULE_SHOW_PREVIOUS_WEEKS"),f=MSGS.get("TIMEANDLABOR_WORKSCHEDULE_SHOW_NEXT_WEEKS");a.push('\x3cbutton id\x3d"',this.id+"_btnPrevWeek",'" class\x3d"btnPrevWeek" title\x3d"',g,'" onclick\x3d"',this.fireCode("_showPreviousWeek"),'"\x3e\x3c/button\x3e');a.push("\x3cspan\x3e");a.push(b.getDate()+" "+c+" - "+d.getDate()+" "+e);a.push("\x3c/span\x3e");
a.push('\x3cbutton id\x3d"',this.id+"_btnNextWeek",'" class\x3d"btnNextWeek" title\x3d"',f,'" onclick\x3d"',this.fireCode("_showNextWeek"),'"\x3e\x3c/button\x3e');a.push("\x3c/div\x3e")},_setFocus:function(a){jQuery(a).focus()},_showPreviousWeek:function(){this._firstBoxDate=new Date(this._firstBoxDate.getFullYear(),this._firstBoxDate.getMonth(),this._firstBoxDate.getDate()-TLMManageWorkSchedulePreview.NUMBER_OF_DAYS);this.refresh(this._workSchedule);this._setFocus(this.jQueryId+"_btnPrevWeek")},
_showNextWeek:function(){this._firstBoxDate=new Date(this._firstBoxDate.getFullYear(),this._firstBoxDate.getMonth(),this._firstBoxDate.getDate()+TLMManageWorkSchedulePreview.NUMBER_OF_DAYS);this.refresh(this._workSchedule);this._setFocus(this.jQueryId+"_btnNextWeek")},_renderWeekDaysHeader:function(a){a.push('\x3cdiv class\x3d"weekdayHeaderArea" aria-hidden\x3d"true"\x3e');for(var b=0;7>b;b++){a.push("\x3cspan\x3e");var c=this._data[b].date.getDay();a.push(window.dateFormatSymbols.shortWeekdays[c]);
a.push("\x3c/span\x3e")}a.push("\x3c/div\x3e")},_renderDays:function(a){a.push('\x3cul class\x3d"calendarDays"\x3e');for(var b=0;b<this._data.length;b++){var c=this._data[b];a.push('\x3cli class\x3d"'+c.dayType+'"\x3e');this._renderDay(c,a);a.push("\x3c/li\x3e")}a.push("\x3c/ul\x3e")},_renderDay:function(a,b){var c=TLMFieldsHelper.UserDateFormatter.format(a.date),d=dateFormatSymbols.weekdays[a.date.getDay()],c=MSGS.get("TIMEANDLABOR_WORKSCHEDULE_PREVIEW_DATE_WITH_WEEKDAY",d,c);b.push('\x3cspan class\x3d"dayNumberText" title\x3d"'+
c+'"\x3e');b.push(a.date.getDate());b.push("\x3c/span\x3e");switch(a.dayType){case TLMManageWorkSchedulePreview.DAYTYPE.NOSELECTION:b.push('\x3cspan class\x3d"noSelectionText"\x3e');b.push(MSGS.get("TIMEANDLABOR_WORKSCHEDULE_PREVIEW_NO_SELECTION"));b.push("\x3c/span\x3e");break;case TLMManageWorkSchedulePreview.DAYTYPE.DAY_OFF:b.push('\x3cspan class\x3d"dayOffText"\x3e');b.push(MSGS.get("TIMEANDLABOR_WORKSCHEDULE_DAY_CATEGORY_DAY_OFF"));b.push("\x3c/span\x3e");break;case TLMManageWorkSchedulePreview.DAYTYPE.WORKING_DAY:"CLOCK_TIME"===
this._workSchedule.getTimeRecordingVariant()?this._renderClockTimeInformation(a,b):(b.push('\x3cspan class\x3d"hoursAndMinutesText"  title\x3d"'+a.wsDay.getFormattedHoursAndMinutesLongText()+'"\x3e'),b.push(a.wsDay.getFormattedHoursAndMinutes()),b.push("\x3c/span\x3e"),this._renderDayModelInformation(a,b))}},_renderDayModelInformation:function(a,b){var c=a.wsDay.getDayModelExtCode();c&&""!==c&&(20>=c.length?(b.push('\x3cspan class\x3d"dayModelText"\x3e'),b.push(Util.escapeHTML(c))):(b.push('\x3cspan class\x3d"dayModelText" title\x3d"'+
Util.escapeHTML(c)+'"\x3e'),b.push(Util.escapeHTML(c.substring(0,20)+"..."))),b.push("\x3c/span\x3e"))},_renderClockTimeInformation:function(a,b){var c="";if(0!==a.wsDay.getWorkingTimeSegments().length)var d=a.wsDay.getWorkingTimeSegments(),c=d[0],c=MSGS.TIMEANDLABOR_WORKSCHEDULE_WORKING_TIME+"\n"+TLMFormatter.formatTimePeriod(c.getStartTime(),c.getEndTime());for(var e="No breaks",g=a.wsDay.getBreakSegments(),f=0;f<g.length;f++)"No breaks"===e?(e=MSGS.TIMEANDLABOR_WORKSCHEDULE_BREAKS+"\n",e+=TLMFormatter.formatBreak(g[f].getStartTime(),
g[f].getEndTime(),g[f].getDuration())):e=e+"\n"+TLMFormatter.formatBreak(g[f].getStartTime(),g[f].getEndTime(),g[f].getDuration());b.push('\x3cspan class\x3d"hoursAndMinutesText"  title\x3d"'+(c+("\n"+e))+'"\x3e');b.push(d[0].getStartTime()+"-"+d[0].getEndTime());b.push("\x3c/span\x3e")},refresh:function(a){this._workSchedule=a;this._data=this._getData();a=[];this._renderContent(a);juic.$(this.id+"_tlmWorkSchedulePreviewContent").innerHTML=a.join("")}});