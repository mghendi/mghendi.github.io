function DPCSAckStatementController(a,b){this._init();this.renderTo(a);this.config=b}
extend(DPCSAckStatementController,EventTarget,{handleEvent:function(a){switch(a.type){case "failedOperation":alert(a.errMsg);this._model.dispatch("failedOperation");break;case "viewStatement":this._dao.viewStatement(a.dpcsVersionId);break;case "viewStatementDone":this._model.dispatch("statementReady",{data:a.data});break;case "retrieveAckStatement":this._dao.retrieveAckStatement(a.userInfo,a.searchType);break;case "retrieveAckStatementDone":this._populateModel(a.data);break;case "updateAckStatement":this._dao.updateAckStatement(a.userInfo,
a.searchType,a.dpcsId,a.status,a.dpcsOrdinal);break;case "updateAckStatementDone":this._model.dispatch("updateAckStatementDone");break;case "purgeFreezeValidation":"Failure"==a.data?this._model.dispatch("updateAckStatementFailedPurgeFreeze"):a.dpcsData&&0==a.dpcsData.isExternal?this._dao.updateRecruitingAckStatementForInternalUser(a.dpcsData):a.dpcsData&&1==a.dpcsData.isExternal&&this._dao.updateRecruitingAckStatementForExternalCandidate(a.dpcsData)}},_init:function(){this._initDAO();this._initModel();
this._initView();this._initEventListeners()},_initModel:function(){this._model=new DPCSAckStatementModel},_populateModel:function(a){this._model.setStatmentList(a);this._model.dispatch("ackStatementModelUpdated")},_initView:function(){this._view=new DPCSAckStatementPage(this._model,this.config)},_initDAO:function(){var a=AjaxService.getMBeanInstance(this.getEndpointName());this._dao=new DPCSAckStatementDAO(a)},_initEventListeners:function(){this._dao.addEventListener("failedOperation",this);this._dao.addEventListener("retrieveAckStatementDone",
this);this._dao.addEventListener("updateAckStatementDone",this);this._dao.addEventListener("updateAckStatementDoneForCandidate",this);this._dao.addEventListener("purgeFreezeValidation",this);this._dao.addEventListener("viewStatementDone",this);this._model.addEventListener("retrieveAckStatement",this);this._model.addEventListener("updateAckStatement",this);this._model.addEventListener("viewStatement",this)},renderTo:function(a){var b=[];this._view.renderHtml(b);$(a).innerHTML=b.join("")},getEndpointName:function(){return"dpcsUserStatusController"}});
function DPCSAckStatementDAO(a){this._endPoint=a}
extend(DPCSAckStatementDAO,EventTarget,{_initCBObject:function(a,b){var c=this;return{callback:function(b){c.dispatch(a,{data:b})},exceptionHandler:function(a,e){c.dispatch(b||"failedOperation",{errMsg:e.message})}}},_initCBObjectWithData:function(a,b,c){var d=this;return{callback:function(b){d.dispatch(a,{data:b,dpcsData:c})},exceptionHandler:function(a,c){d.dispatch(b||"failedOperation",{errMsg:c.message})}}},retrieveAckStatement:function(a,b){if(b==dpcsUtil.SEARCH_TYPE_USER){var c;this._endPoint.getInternalUserDpcsStatus(a,
this._initCBObject("retrieveAckStatementDone"))}else b==dpcsUtil.SEARCH_TYPE_SIMPLIFIED_ONBOARDING?this._endPoint.getOnb2Status(a,this._initCBObject("retrieveAckStatementDone")):b==dpcsUtil.SEARCH_TYPE_ONBOARDING?(c=a.userId,this._endPoint.getExternalUserDpcsStatus(c,a.country||null,this._initCBObject("retrieveAckStatementDone"))):(c=JSON.parse(a),this._endPoint.getExternalCandidateDpcsStatus(c.candId,c.countryCode,c.isPublicIntranet,this._initCBObject("retrieveAckStatementDone")))},viewStatement:function(a){this._endPoint.getDpscStatement(a,
this._initCBObject("viewStatementDone"))},getStatementByType:function(a,b){null==b?this._endPoint.getDpscStatementByType(a,this._initCBObject("getStatementByTypeDone")):this._endPoint.getDpscStatementByTypeAndCountry(a,b,this._initCBObject("getStatementByTypeDone"))},getStatementByTypes:function(a){this._endPoint.getDpscStatementByTypes(a,this._initCBObject("getStatementByTypesDone"))},updateAckStatement:function(a,b,c,d,e){b==dpcsUtil.SEARCH_TYPE_USER||b==dpcsUtil.SEARCH_TYPE_SIMPLIFIED_ONBOARDING?
this._isRecruitingDpcs(e)&&0==d?this._endPoint.checkForPurgeFreeze(a,!0,this._initCBObjectWithData("purgeFreezeValidation",null,{isExternal:!1,id:a,dpcsId:c,status:d})):this._endPoint.saveInternalUserDpcsStatus(a,c,d,!0,this._initCBObject("updateAckStatementDone")):b==dpcsUtil.SEARCH_TYPE_CANDIDATE||b==dpcsUtil.SEARCH_TYPE_INTRANET_CANDIDATE?(a=JSON.parse(a).candId,this._isRecruitingDpcs(e)&&0==d?this._endPoint.checkForPurgeFreeze(a,!1,this._initCBObjectWithData("purgeFreezeValidation",null,{isExternal:!0,
id:a,dpcsId:c,status:d})):this._endPoint.saveExternalCandidateDpcsStatus(a,c,d,!0,this._initCBObject("updateAckStatementDone"))):b==dpcsUtil.SEARCH_TYPE_ONBOARDING&&(a=a.userId,this._endPoint.saveExternalUserDpcsStatus(a,c,d,!0,this._initCBObject("updateAckStatementDone")))},updateRecruitingAckStatementForInternalUser:function(a){this._endPoint.saveInternalUserDpcsStatus(a.id,a.dpcsId,a.status,!0,this._initCBObject("updateAckStatementDone"))},updateRecruitingAckStatementForExternalCandidate:function(a){this._endPoint.saveExternalCandidateDpcsStatus(a.id,
a.dpcsId,a.status,!0,this._initCBObject("updateAckStatementDone"))},_isRecruitingDpcs:function(a){return a==dpcsUtil.RECRUITING_INTERNAL||a==dpcsUtil.RECRUITING_EXTERNAL||a==dpcsUtil.RECRUITING_INTRANET?!0:!1}});