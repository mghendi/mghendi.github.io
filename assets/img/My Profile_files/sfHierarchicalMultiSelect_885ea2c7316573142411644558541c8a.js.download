function SFDefaultNodeElement(a){juic.assert("undefined"!=typeof a,"[SFDefaultNodeElement] No data was passed");this._value=a.value;this._text=a.text;(this._hasChildren=a.hasChildren)&&a.childrenList&&0<a.childrenList.length&&this.setChildrenList(a.childrenList)}
(function(){juic.extend(SFDefaultNodeElement,juic.EventTarget,{setValue:function(a){this._value=a},getValue:function(){return this._value},setText:function(a){this._text=a},toString:function(){return this._text},getText:function(){return this._text},hasChildren:function(){return this._hasChildren},setHasChildren:function(a){this._hasChildren=a},setChildrenList:function(a){if((this._childrenList=a)&&0<a.length){this._hasChildren=!0;for(var c=a.length,b=[],d=0;d<c;d++)b.push(new SFDefaultNodeElement(a[d]));
this._childrenList=b}this.dispatch("childrenUpdated",{node:this})},getChildrenList:function(){return this._childrenList},isChildrenAvailable:function(){return!!(this._childrenList&&0<this._childrenList.length)},setChildrenDataModel:function(a){this._childrenModel=a},getChildrenDataModel:function(){return this._childrenModel}})})();
function SFDefaultHierarchicalModel(a){juic.assert(a,"[SFDefaultHierarchicalModel] No items were passed");this._partialSelectedIndices=[];this._super(a);for(var c=a.length,b=0;b<c;b++)a[b].hasChildren()&&a[b].addEventListener("childrenUpdated",this,"_childListUpdated"),a[b].isChildrenAvailable()&&(a[b].setChildrenDataModel(this.createChildModel(a[b].getChildrenList())),a[b].getChildrenDataModel().addEventListener("selectionChanged",this,"_handleChildModelUpdated"))}
(function(){juic.extend(SFDefaultHierarchicalModel,SFDefaultMultiSelectModel,{addSelectedIndex:function(a,c){juic.assert(0<=a&&a<this.size(),"[SFDefaultMultiSelectModel] Invalid index: "+a);for(var b=0,d=this._partialSelectedIndices.length;b<d;b++)if(this._partialSelectedIndices[b]===a){this._partialSelectedIndices.splice(b,1);break}this._selectedIndices.contains(a)||(this._selectedIndices.push(a),c||this._changeChildrenState([a],!0));this._ignoreChildUpdates||this.dispatch("selectionChanged")},addPartialSelectedIndex:function(a){juic.assert(0<=
a&&a<this.size(),"[SFDefaultHierarchicalModel] Invalid index: "+a);for(var c=0,b=this._selectedIndices.length;c<b;c++)if(this._selectedIndices[c]===a){this._selectedIndices.splice(c,1);break}this._partialSelectedIndices.contains(a)||this._partialSelectedIndices.push(a);this._ignoreChildUpdates||this.dispatch("selectionChanged")},_childListUpdated:function(a){var c=a.node.getChildrenList();a.node.setChildrenDataModel(this.createChildModel(c))},_handleChildModelUpdated:function(){this._ignoreChildUpdates||
this._updateSelectedIndices()},_updateSelectedIndices:function(){var a=this.size(),c=this._ignoreChildUpdates;this._ignoreChildUpdates=!0;for(var b=0;b<a;b++){var d=this.get(b).getChildrenDataModel();d&&(d.isAllSelected()?this.addSelectedIndex(b,!0):d.isPartiallySelected()?this.addPartialSelectedIndex(b,!0):this.removeSelectedIndex(b,!0))}this.dispatch("selectionChanged");this._ignoreChildUpdates=c},_changeChildrenState:function(a,c){var b=a&&a.length,d=this._ignoreChildUpdates;this._ignoreChildUpdates=
!0;for(var e=0;e<b;e++){var f=this.get(a[e]).getChildrenDataModel();f&&(c?f.selectAll():f.deselectAll())}this._ignoreChildUpdates=d},isAllSelected:function(){return this._selectedIndices.length==this.size()},isPartiallySelected:function(){return!this.isAllSelected()&&0<this.getSelectedCount()},deselectAll:function(){0<this._selectedIndices.length&&(this._changeChildrenState(this._selectedIndices,!1),this._selectedIndices.length=0,this._partialSelectedIndices.length=0,this._changeChildrenState(this._partialSelectedIndices,
!1),this.dispatch("selectionChanged"))},selectAll:function(){this._selectedIndices.length=0;for(var a=this._partialSelectedIndices.length=0,c=this.size();a<c;a++)this._selectedIndices.push(a);this._changeChildrenState(this._selectedIndices,!0);this.dispatch("selectionChanged")},removeSelectedIndex:function(a,c){for(var b=[this._selectedIndices,this._partialSelectedIndices],d=0;d<b.length;d++)for(var e=b[d],f=0,g=e.length;f<g;f++)if(e[f]===a){e.splice(f,1);c||this._changeChildrenState([a],!1);this._ignoreChildUpdates||
this.dispatch("selectionChanged");break}},setSelectedIndices:function(a){this._changeChildrenState(this._selectedIndices,!1);this._selectedIndices=[];this._partialSelectedIndices=[];var c=this._ignoreChildUpdates;this._ignoreChildUpdates=!0;for(var b in a)if(this._selectedIndices.push(+b),"object"==typeof a[b]){var d=this.get(b);d.isChildrenAvailable()&&d.getChildrenDataModel().setSelectedIndices(a[b])}else this._changeChildrenState([b],!0);this._updateSelectedIndices();this._ignoreChildUpdates=c;
this.dispatch("selectionChanged")},getItemCount:function(a){for(var c=a=0;c<this.size();c++){var b=this.get(c);b&&null!=b.getChildrenList()?a+=b.getChildrenDataModel().getItemCount():a++}return a},isIndexSelected:function(a){return this._selectedIndices.contains(a)||this._partialSelectedIndices.contains(a)},getSelectedCount:function(){return this._selectedIndices.length+this._partialSelectedIndices.length},getSelectedIndices:function(){for(var a={},c=this._selectedIndices.concat(this._partialSelectedIndices),
b=0,d=c.length;b<d;b++){var e=this.get(c[b]);e.isChildrenAvailable()?a[c[b]]=e.getChildrenDataModel().getSelectedIndices():a[c[b]]=!0}return a},getSelectedValues:function(){for(var a={},c=this._selectedIndices.concat(this._partialSelectedIndices),b=0,d=c.length;b<d;b++){var e=this.get(c[b]);e.isChildrenAvailable()?a[this.get(c[b]).getValue()]=e.getChildrenDataModel().getSelectedValues():a[this.get(c[b]).getValue()]=!0}return a},getSelectionsTextAndValue:function(a,c){c=c||[];a=a||{value:"",text:""};
for(var b=this._selectedIndices.concat(this._partialSelectedIndices),d=0,e=b.length;d<e;d++){var f=this.get(b[d]),g={value:a.value?a.value+":"+f.getValue():f.getValue(),text:a.text?a.text+":"+f.getText():f.getText()};f.isChildrenAvailable()?f.getChildrenDataModel().getSelectionsTextAndValue(g,c):c.push({value:a.value?a.value+":"+f.getValue():f.getValue(),text:a.text?a.text+":"+f.getText():f.getText()})}return c},_getIndicesForValues:function(a){for(var c={},b=0;b<this.size();b++){var d=this.get(b).getValue();
a[d]&&(!0===a[d]?c[b]=!0:this.get(b).hasChildren()&&(c[b]=this.get(b).getChildrenDataModel()._getIndicesForValues(a[d])))}return c},setSelectedValues:function(a){a&&(a=this._getIndicesForValues(a,this),this.setSelectedIndices(a))},getAllSelectedValuesAtLevel:function(a,c){for(var b=[],d=this._selectedIndices.concat(this._partialSelectedIndices),e=0,f=d.length;e<f;e++){var g=this.get(d[e]);if(c==a)b.push(this.get(d[e]).getValue());else if(g.isChildrenAvailable())var h=c+1,g=g.getChildrenDataModel().getAllSelectedValuesAtLevel(a,
h),b=b.concat(g)}return b},createChildModel:function(a){return new SFDefaultHierarchicalModel(a)}})})();
function SFHeirarchicalMultiSelect(a,c){this._super(a,c);var b=new juic.Config(c,{expandedClass:"sfHeirarchicalMSExpanded",collapsedClass:"sfHeirarchicalMSCollapsed",childMenuContainerClass:"sfHeirarchicalMSChildMenuContainer"});this._expandedMenuClass=b.expandedClass;this._collapsedMenuClass=b.collapsedClass;this._childMenuContainerClass=b.childMenuContainerClass;this._toggleClass=b.toggleClass;this._rootSelect=!1!==b.rootSelect;this._childSelect={}}
(function(){juic.extend(SFHeirarchicalMultiSelect,SFCheckboxMultiSelect,{cleanup:function(){for(var a in this._childSelect)this._childSelect[a].cleanup();this._super()},setModel:function(a){this._model=Array.isArray(a)?new SFDefaultHierarchicalModel(a):a;this._updateModel()},_toggleChildMenu:function(a){var c=juic.$(this._getToggleElementId(a));if(c){var b=SFDom.getParent(c);SFDom.toggleAriaAttribute(b,"aria-expanded");c.className=c.className===this._expandedMenuClass?this._collapsedMenuClass:this._expandedMenuClass}if(c=
juic.$(this._getChildContainerId(a)))c&&"block"===SFDom.getStyle(c,"display")?c.style.display="none":((b=this._childSelect[a])||(b=this._childSelect[a]=this.createChildSelect(this._model.get(a).getChildrenDataModel(),{rootSelect:!1})),juic.$(b.getReferenceId())||b.render(c),c.style.display="block")},_renderContent:function(a){for(var c=[],b=0,d=this._model.size();b<d;b++){var e=this._model.get(b),f=this.isIndexSelected(b);a.push('\x3cli class\x3d"sfHeirarchicalMSCheckRow',f?" "+this._toggleClass:
"",this._rootSelect?" rootMSCheckRow":"",'"');e.hasChildren()?a.push(' style\x3d"position:relative;" \x3e'):a.push("\x3e");a.push('\x3cdiv id\x3d"',this._getWrapperContainerId(b),'" class\x3d"sfHMSCheckRowWrapper"');a.push(' onkeydown\x3d"',this.fireCode("_keyDown",b),'" onkeyup\x3d"',this.fireCode("_keyUp",b),'"');a.push(' aria-expanded\x3d"false", role\x3d"button"');0==b&&this._rootSelect&&a.push(' tabindex\x3d"',0,'"');a.push("\x3e");e.hasChildren()&&(a.push('\x3cspan class\x3d"',this._collapsedMenuClass),
a.push('" onclick\x3d"',this.fireCode("_toggleChildMenu",b)),a.push('" id\x3d"',this._getToggleElementId(b),'"\x3e\x3c/span\x3e'));f=new SFCheckBoxInput("value",e.getText(),f,!0,"",!0);f.index=b;f.addEventListener("change",this,"_onClick");e.hasChildren()?(Util.addClass(f,"parentChkBx"),e.getChildrenDataModel().isAllSelected()?f.setState(SFCheckBoxStates.CHECKBOX_CHECKED):e.getChildrenDataModel().isPartiallySelected()&&(f.setState(SFCheckBoxStates.CHECKBOX_INDETERMINATE),c.push(f))):this._model.isIndexSelected(b)&&
f.setState(SFCheckBoxStates.CHECKBOX_CHECKED);this.isIndexEnabled(b)||f.setEnabled(!1);e.checkbox=f;a.push(f);a.push("\x3c/div\x3e");e.hasChildren()&&(a.push('\x3cdiv class\x3d"',this._childMenuContainerClass),a.push('" id\x3d"',this._getChildContainerId(b)),a.push('" style\x3d"display:none"\x3e'),a.push("\x3c/div\x3e"))}c.length&&a.addAfterRenderListener({handleEvent:function(){for(var a=0;a<c.length;a++)c[a].setState(SFCheckBoxStates.CHECKBOX_INDETERMINATE)}})},renderLabel:function(a,c){a.push(juic.escapeHTML(c.getText()))},
_keyDown:function(a,c){var b=SFDOMEvent.getKeyName(c);if("ARROWUP"==b||"ARROWDOWN"==b||"ARROWLEFT"==b||"ARROWRIGHT"==b){SFDOMEvent.stopEvent(c);var d=c.currentTarget;if("ARROWUP"==b||"ARROWDOWN"==b){for(var e=SFDom.getElementsByClassName("sfHMSCheckRowWrapper","div",SFDom.getParent(SFDom.getAncestorByClassName(d,"rootMSCheckRow"))),f,g=0;g<e.length;g++)if(d.id==e[g].id){f=g;break}g=1;for("ARROWUP"==b&&(g=-1);e[f+g];){f+=g;for(var h=SFDom.getParent(e[f]),k=[];!SFDom.hasClass(h,"rootMSCheckRow");)k.push(SFDom.getAncestorByClassName(h,
"sfHeirarchicalMSChildMenuContainer")),h=SFDom.getAncestorByClassName(h,"sfHeirarchicalMSCheckRow");var l=!0;k.forEach(function(a,b){"none"==a.style.display&&(l=!1)});if(l){d.setAttribute("tabindex",-1);e=e[f];e.setAttribute("tabindex",0);e.focus();break}}}if("ARROWLEFT"==b||"ARROWRIGHT"==b)b="ARROWLEFT"==b?this._expandedMenuClass:this._collapsedMenuClass,SFDom.hasClass(SFDom.getFirstChild(d),b)&&this._toggleChildMenu(a)}},_keyUp:function(a,c){var b=SFDOMEvent.getKeyName(c);if("SPACEBAR"==b||"RETURN"==
b)SFDOMEvent.stopEvent(c),this._model.get(a).checkbox.click()},handleEvent:function(a){var c=juic.$(this.id);switch(a.type){case "selectionChanged":if(c)for(a=0,c=this._model.size();a<c;a++){var b=this._model.get(a),d=juic.$(this.id+a);if(b.hasChildren()){var e=b.getChildrenDataModel();e.isAllSelected()?b.checkbox.setState(SFCheckBoxStates.CHECKBOX_CHECKED):e.isPartiallySelected()?b.checkbox.setState(SFCheckBoxStates.CHECKBOX_INDETERMINATE):b.checkbox.setState(SFCheckBoxStates.CHECKBOX_UNCHECKED);
d&&d.parentNode&&(d.parentNode.className=this.isIndexSelected(a)?this._toggleClass:"")}else d=this.isIndexSelected(a),b.checkbox.setState(d?SFCheckBoxStates.CHECKBOX_CHECKED:SFCheckBoxStates.CHECKBOX_UNCHECKED)}this._includeCheckAll&&(this._model.isAllSelected()?this.selectAllCheckbox.setState(SFCheckBoxStates.CHECKBOX_CHECKED):this._model.isPartiallySelected()?this.selectAllCheckbox.setState(SFCheckBoxStates.CHECKBOX_INDETERMINATE):this.selectAllCheckbox.setState(SFCheckBoxStates.CHECKBOX_UNCHECKED));
this.dispatch("selectionChanged");break;default:this._super(a)}},getSelectedValues:function(){return this._model.getSelectedValues()},getSelectedIndices:function(){return this._model.getSelectedIndices()},getSelectedValuesAtLevel:function(a){return this._model.getAllSelectedValuesAtLevel(a||1,1)},_getToggleElementId:function(a){return this.id+"_"+a+"_expandCollapse"},_getChildContainerId:function(a){return this.id+"_"+a+"_childMenu"},_getWrapperContainerId:function(a){return this.id+"_"+a+"_divWrapper"},
createChildSelect:function(a,c){return new SFHeirarchicalMultiSelect(a,c)}})})();function SFHeirarchicalMultiSelectSelections(a){this.register();this._init(a)}
(function(){juic.extend(SFHeirarchicalMultiSelectSelections,juic.Component,{_init:function(a){this._hasPrimary=a.hasPrimary;a.selections&&(assert(a.selections instanceof Array,"[SFHeirarchicalMultiSelectSelections] Selections must be an array"),this._selections=a.selections);this._hasPrimary&&a.primaryValue&&(this._primaryValue=a.primaryValue);this._pageModel=new SFBoundedRangeModel(0,this._selections?this._selections.length-1:0,0,100);this._pageModel.addEventListener("rangeModelChanged",this,"_reRender");
this._pagination=new SFPagination({model:this._pageModel});this._pagination.addEventListener("action",this,"_onPageAdjust")},cleanup:function(){this._pagination.cleanup();this._super()},hasPrimary:function(){return this._hasPrimary},_onClick:function(a){this._primaryValue=a=a&&a.target&&a.target.value||a&&a.srcElement&&a.srcElement.value;this.dispatch("primaryValueChanged",{newPrimaryValue:a})},_onPageAdjust:function(a){"pageAdjust"==a.actionCommand&&("number"==typeof a.newPage&&this._pageModel.setValue((a.newPage-
1)*this._pageModel.getExtent()),a=parseInt(a.newPageSize),isNaN(a)||this._pageModel.setExtent(a))},renderHtml:function(a){a.push('\x3cdiv id\x3d"',this.id,'" class\x3d"SFHeirarchicalMultiSelectSelections"\x3e\x3cdiv id\x3d"',this.id,'content" class\x3d"SFHeirarchicalMultiSelectSelectionsContainer"\x3e');this._renderContent(a);a.push('\x3c/div\x3e\x3cdiv id\x3d"',this.id,'pagination"');this._isPaginationRequired()||a.push(' style\x3d"display:none"');a.push("\x3e",this._pagination,"\x3c/div\x3e")},
_renderContent:function(a){a.push("\x3ctable style\x3d'width:100%;'\x3e");for(var c=this.hasPrimary(),b=c&&this._determinePrimaryValue(),d=this._selections.length,e=this._pageModel.getValue(),f=e+this._pageModel.getExtent();e<Math.min(d,f);e++){var g=this._selections[e];a.push("\x3ctr id\x3d'",this.id,e,"_row'\x3e");a.push("\x3ctd style\x3d'width:80%;' class\x3d\"SFHeirarchicalMultiSelectSelectionsRow\"\x3e");a.push(juic.escapeHTML(g.text));a.push("\x3c/td\x3e");if(c){var h=g.value==b?" checked\x3d'checked'":
"";a.push('\x3ctd style\x3d"width:20%;text-align:center;"\x3e\x3cinput type\x3d"radio" name\x3d"',this.id,'_primary" value\x3d"',g.value,'" onclick\x3d"',this.fireCode("_onClick"),'"',h,"/\x3e\x3c/td\x3e")}a.push("\x3c/tr\x3e")}a.push("\x3c/table\x3e")},_updatePagination:function(){if(this._selections){this._pageModel.setMaximum(this._selections.length-1);var a=juic.$(this.id+"pagination");a&&(a.style.display=this._isPaginationRequired()?"":"none")}},_isPaginationRequired:function(){return this._selections&&
100<this._selections.length},setSelections:function(a){assert(a instanceof Array,"[SFHeirarchicalMultiSelectSelections] Selections must be an array");this._selections=a;this._updatePagination();this._primaryValue=this._determinePrimaryValue();this._reRender()},_isValueInSelections:function(a){for(var c=this._selections&&this._selections.length,b=0;b<c;b++)if(this._selections[b].value==a)return!0;return!1},setPrimaryValue:function(a){var c=juic.$(this.id+"_"+a);c&&(c.checked=!0,this.dispatch("primaryValueChanged",
{newPrimaryValue:a}))},_determinePrimaryValue:function(){var a;this._selections&&this._selections.length&&(a=this.getPrimaryValue(),!this._isValueInSelections(a)&&this._selections&&0<this._selections.length&&(a=this._selections[0].value));return a},getPrimaryValue:function(){return this._primaryValue},initPrimaryValue:function(a){this._primaryValue=a},getNoOfSelections:function(){return this._selections.length},_reRender:function(){var a=juic.$(this.id+"content");if(a){var c=juic.createRenderContext();
this._renderContent(c);c.renderInto(a)}}})})();function SFMultiSelectView(a,c,b){this.register();this._init(a,c,b)}
(function(){juic.extend(SFMultiSelectView,juic.Component,{_init:function(a,c,b){var d=new juic.Config(b,{className:"hierarchicalSelect",multiSelectClassName:"componentContainer",selectionClassName:"componentContainer selectionContainer"});this.multiSelectComp=a;this.singleSelectComp=c;this._selectAll=b.selectAll;this.totalItemCount=b.itemCount;this.totalSelectedItems=c.getNoOfSelections();this._className=d.className;this._multiSelectClassName=d.multiSelectClassName;this._selectionClassName=d.selectionClassName},
setTotalSelectedItems:function(a){this.totalSelectedItems=a;var c=juic.$(this.id+"Selected");c&&(c.innerText=sfMessageFormat.format(MSGS.COMMON_MultiSelect_Hierarchical_Selected_Label,a))},renderHtml:function(a){a.push("\x3ctable id\x3d'",this.id,"' class\x3d'",this._className,"'\x3e");a.push("\x3ctr\x3e");a.push("\x3ctd class\x3d'headerContainer globalPrimaryElement' style\x3d'width:45%;'\x3e\x3cdiv class\x3d'headerText'\x3e");a.push(sfMessageFormat.format(MSGS.COMMON_MultiSelect_Hierarchical_Available_Label,
this.totalItemCount));a.push("\x3c/div\x3e\x3c/td\x3e");a.push("\x3ctd class\x3d'headerContainer globalPrimaryElement'\x3e\x3cdiv class\x3d'headerText'\x3e");a.push("\x3cspan id\x3d'",this.id,"Selected' style\x3d'float:left;'\x3e",sfMessageFormat.format(MSGS.COMMON_MultiSelect_Hierarchical_Selected_Label,this.totalSelectedItems),"\x3c/span\x3e");a.push("\x3cspan style\x3d'float:right;padding-right:5px;'\x3e\x3cspan style\x3d'color:red;'\x3e*\x3c/span\x3e",MSGS.COMMON_MultiSelect_Hierarchical_Primary_Label,
"\x3c/span\x3e");a.push("\x3cdiv class\x3d'hangingDiv'\x3e\x3c/div\x3e");a.push("\x3c/div\x3e\x3c/td\x3e");a.push("\x3c/tr\x3e");a.push("\x3ctr\x3e");a.push("\x3ctd style\x3d'border-right:1px solid #ccc; vertical-align:top;'\x3e");a.push("\x3cdiv\x3e");a.push("\x3cdiv class\x3d'selectAllContainer'\x3e");this._selectAll.renderHtml(a);a.push("\x3c/div\x3e");a.push("\x3cdiv class\x3d'",this._multiSelectClassName,"' style\x3d'width:auto;max-height:",300,"px;*height:",250,"px;'\x3e");this.multiSelectComp.renderHtml(a);
a.push("\x3c/div\x3e");a.push("\x3c/div\x3e");a.push("\x3c/td\x3e");a.push("\x3ctd style\x3d'vertical-align:top;'\x3e");a.push("\x3cdiv class\x3d'",this._selectionClassName,"' style\x3d'max-height:",320,"px;*height:",270,"px;'\x3e");this.singleSelectComp.renderHtml(a);a.push("\x3c/div\x3e");a.push("\x3c/td\x3e");a.push("\x3c/tr\x3e");a.push("\x3c/table\x3e")}})})();